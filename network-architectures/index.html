



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Guide for openstack-ansible Deployers">
      
      
        <link rel="canonical" href="https://ostackdoc.github.io/network-architectures/">
      
      
        <meta name="author" content="Chinthaka Deshapriya">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.0.2">
    
    
      
        <title>Network Architectures - Openstack Ansible Deployment Guide</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.982221ab.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.224b79ff.css">
      
      
        
        
        <meta name="theme-color" content="#3f51b5">
      
    
    
      <script src="../assets/javascripts/modernizr.1f0bcf2b.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
      <link rel="manifest" href="../manifest.webmanifest">
    
    
      <link rel="stylesheet" href="../extra.css">
    
    
      
        
<script>
  window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date
  /* Setup integration and send page view */
  ga("create", "UA-136248088-1", "ostackdoc.github.io")
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")
  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  })
</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#management_network" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://ostackdoc.github.io" title="Openstack Ansible Deployment Guide" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Openstack Ansible Deployment Guide
            </span>
            <span class="md-header-nav__topic">
              Network Architectures
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/ostackdoc/ostackdoc-docs/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    ostackdoc/ostackdoc-docs
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://ostackdoc.github.io" title="Openstack Ansible Deployment Guide" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Openstack Ansible Deployment Guide
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/ostackdoc/ostackdoc-docs/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    ostackdoc/ostackdoc-docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Network Architectures
      </label>
    
    <a href="./" title="Network Architectures" class="md-nav__link md-nav__link--active">
      Network Architectures
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#management_network" title="Management Network" class="md-nav__link">
    Management Network
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#overlay_network" title="Overlay Network" class="md-nav__link">
    Overlay Network
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#storage_network" title="Storage Network" class="md-nav__link">
    Storage Network
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_interfaces" title="Network Interfaces" class="md-nav__link">
    Network Interfaces
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#single_interface_or_bond" title="Single Interface or Bond" class="md-nav__link">
    Single Interface or Bond
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#single_bond_sample_network_configuration" title="Single Bond Sample Network Configuration" class="md-nav__link">
    Single Bond Sample Network Configuration
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create_a_bonded_interface_note_that_the_bond-slaves_is_set_to_none_this" title="Create a bonded interface. Note that the "bond-slaves" is set to none. This" class="md-nav__link">
    Create a bonded interface. Note that the "bond-slaves" is set to none. This
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#is_because_the_bond-master_has_already_been_set_in_the_raw_interfaces_for" title="is because the bond-master has already been set in the raw interfaces for" class="md-nav__link">
    is because the bond-master has already been set in the raw interfaces for
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the_new_bond0" title="the new bond0." class="md-nav__link">
    the new bond0.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#containerhost_management_vlan_interface" title="Container/Host management VLAN interface" class="md-nav__link">
    Container/Host management VLAN interface
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openstack_networking_vxlan_tunneloverlay_vlan_interface" title="OpenStack Networking VXLAN (tunnel/overlay) VLAN interface" class="md-nav__link">
    OpenStack Networking VXLAN (tunnel/overlay) VLAN interface
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#storage_network_vlan_interface_optional" title="Storage network VLAN interface (optional)" class="md-nav__link">
    Storage network VLAN interface (optional)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#containerhost_management_bridge" title="Container/Host management bridge" class="md-nav__link">
    Container/Host management bridge
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openstack_networking_vxlan_tunneloverlay_bridge" title="OpenStack Networking VXLAN (tunnel/overlay) bridge" class="md-nav__link">
    OpenStack Networking VXLAN (tunnel/overlay) bridge
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nodes_hosting_neutron_agents_must_have_an_ip_address_on_this_interface" title="Nodes hosting Neutron agents must have an IP address on this interface," class="md-nav__link">
    Nodes hosting Neutron agents must have an IP address on this interface,
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#including_compute_network_and_collapsed_infranetwork_nodes" title="including COMPUTE, NETWORK, and collapsed INFRA/NETWORK nodes." class="md-nav__link">
    including COMPUTE, NETWORK, and collapsed INFRA/NETWORK nodes.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openstack_networking_vlan_bridge" title="OpenStack Networking VLAN bridge" class="md-nav__link">
    OpenStack Networking VLAN bridge
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the_br-vlan_bridge_is_no_longer_necessary_for_deployments_unless_neutron" title="The "br-vlan" bridge is no longer necessary for deployments unless Neutron" class="md-nav__link">
    The "br-vlan" bridge is no longer necessary for deployments unless Neutron
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agents_are_deployed_in_a_container_instead_a_direct_interface_such_as" title="agents are deployed in a container. Instead, a direct interface such as" class="md-nav__link">
    agents are deployed in a container. Instead, a direct interface such as
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bond0_can_be_specified_via_the_host_bind_override_override_when_defining" title="bond0 can be specified via the "host_bind_override" override when defining" class="md-nav__link">
    bond0 can be specified via the "host_bind_override" override when defining
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#provider_networks" title="provider networks." class="md-nav__link">
    provider networks.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#auto_br-vlan" title="auto br-vlan" class="md-nav__link">
    auto br-vlan
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iface_br-vlan_inet_manual" title="iface br-vlan inet manual" class="md-nav__link">
    iface br-vlan inet manual
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bridge_stp_off" title="bridge_stp off" class="md-nav__link">
    bridge_stp off
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bridge_waitport_0" title="bridge_waitport 0" class="md-nav__link">
    bridge_waitport 0
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bridge_fd_0" title="bridge_fd 0" class="md-nav__link">
    bridge_fd 0
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bridge_ports_bond0" title="bridge_ports bond0" class="md-nav__link">
    bridge_ports bond0
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compute1_network_vlan_bridge" title="compute1 Network VLAN bridge" class="md-nav__link">
    compute1 Network VLAN bridge
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#auto_br-vlan_1" title="auto br-vlan" class="md-nav__link">
    auto br-vlan
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iface_br-vlan_inet_manual_1" title="iface br-vlan inet manual" class="md-nav__link">
    iface br-vlan inet manual
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bridge_stp_off_1" title="bridge_stp off" class="md-nav__link">
    bridge_stp off
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bridge_waitport_1" title="bridge_waitport 0" class="md-nav__link">
    bridge_waitport 0
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bridge_fd_1" title="bridge_fd 0" class="md-nav__link">
    bridge_fd 0
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#storage_bridge_optional" title="Storage bridge (optional)" class="md-nav__link">
    Storage bridge (optional)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#only_the_compute_and_storage_nodes_must_have_an_ip_address" title="Only the COMPUTE and STORAGE nodes must have an IP address" class="md-nav__link">
    Only the COMPUTE and STORAGE nodes must have an IP address
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#on_this_bridge_when_used_by_infrastructure_nodes_the" title="on this bridge. When used by infrastructure nodes, the" class="md-nav__link">
    on this bridge. When used by infrastructure nodes, the
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ip_addresses_are_assigned_to_containers_which_use_this" title="IP addresses are assigned to containers which use this" class="md-nav__link">
    IP addresses are assigned to containers which use this
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bridge" title="bridge." class="md-nav__link">
    bridge.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compute1_storage_bridge" title="compute1 Storage bridge" class="md-nav__link">
    compute1 Storage bridge
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#auto_br-storage" title="auto br-storage" class="md-nav__link">
    auto br-storage
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iface_br-storage_inet_static" title="iface br-storage inet static" class="md-nav__link">
    iface br-storage inet static
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bridge_stp_offauto_br-storage" title="bridge_stp off#auto br-storage" class="md-nav__link">
    bridge_stp off#auto br-storage
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bridge_waitport_2" title="bridge_waitport 0" class="md-nav__link">
    bridge_waitport 0
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bridge_fd_2" title="bridge_fd 0" class="md-nav__link">
    bridge_fd 0
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bridge_ports_bond020" title="bridge_ports bond0.20" class="md-nav__link">
    bridge_ports bond0.20
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#address_1722924416" title="address 172.29.244.16" class="md-nav__link">
    address 172.29.244.16
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#netmask_2552552520" title="netmask 255.255.252.0" class="md-nav__link">
    netmask 255.255.252.0
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../prepare-deployment-host/" title="Prepare Deployment Host" class="md-nav__link">
      Prepare Deployment Host
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../prepare-the-target-hosts/" title="Prepare the Target Hosts" class="md-nav__link">
      Prepare the Target Hosts
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../test-env-example/" title="Test Environment Example" class="md-nav__link">
      Test Environment Example
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Preparing OpenStack Nodes
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Preparing OpenStack Nodes
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../install-node-os/" title="Installing Node OS" class="md-nav__link">
      Installing Node OS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../configure-node-network/" title="Configuring Node Network" class="md-nav__link">
      Configuring Node Network
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#management_network" title="Management Network" class="md-nav__link">
    Management Network
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#overlay_network" title="Overlay Network" class="md-nav__link">
    Overlay Network
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#storage_network" title="Storage Network" class="md-nav__link">
    Storage Network
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_interfaces" title="Network Interfaces" class="md-nav__link">
    Network Interfaces
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#single_interface_or_bond" title="Single Interface or Bond" class="md-nav__link">
    Single Interface or Bond
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#single_bond_sample_network_configuration" title="Single Bond Sample Network Configuration" class="md-nav__link">
    Single Bond Sample Network Configuration
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create_a_bonded_interface_note_that_the_bond-slaves_is_set_to_none_this" title="Create a bonded interface. Note that the "bond-slaves" is set to none. This" class="md-nav__link">
    Create a bonded interface. Note that the "bond-slaves" is set to none. This
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#is_because_the_bond-master_has_already_been_set_in_the_raw_interfaces_for" title="is because the bond-master has already been set in the raw interfaces for" class="md-nav__link">
    is because the bond-master has already been set in the raw interfaces for
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the_new_bond0" title="the new bond0." class="md-nav__link">
    the new bond0.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#containerhost_management_vlan_interface" title="Container/Host management VLAN interface" class="md-nav__link">
    Container/Host management VLAN interface
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openstack_networking_vxlan_tunneloverlay_vlan_interface" title="OpenStack Networking VXLAN (tunnel/overlay) VLAN interface" class="md-nav__link">
    OpenStack Networking VXLAN (tunnel/overlay) VLAN interface
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#storage_network_vlan_interface_optional" title="Storage network VLAN interface (optional)" class="md-nav__link">
    Storage network VLAN interface (optional)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#containerhost_management_bridge" title="Container/Host management bridge" class="md-nav__link">
    Container/Host management bridge
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openstack_networking_vxlan_tunneloverlay_bridge" title="OpenStack Networking VXLAN (tunnel/overlay) bridge" class="md-nav__link">
    OpenStack Networking VXLAN (tunnel/overlay) bridge
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nodes_hosting_neutron_agents_must_have_an_ip_address_on_this_interface" title="Nodes hosting Neutron agents must have an IP address on this interface," class="md-nav__link">
    Nodes hosting Neutron agents must have an IP address on this interface,
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#including_compute_network_and_collapsed_infranetwork_nodes" title="including COMPUTE, NETWORK, and collapsed INFRA/NETWORK nodes." class="md-nav__link">
    including COMPUTE, NETWORK, and collapsed INFRA/NETWORK nodes.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openstack_networking_vlan_bridge" title="OpenStack Networking VLAN bridge" class="md-nav__link">
    OpenStack Networking VLAN bridge
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the_br-vlan_bridge_is_no_longer_necessary_for_deployments_unless_neutron" title="The "br-vlan" bridge is no longer necessary for deployments unless Neutron" class="md-nav__link">
    The "br-vlan" bridge is no longer necessary for deployments unless Neutron
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agents_are_deployed_in_a_container_instead_a_direct_interface_such_as" title="agents are deployed in a container. Instead, a direct interface such as" class="md-nav__link">
    agents are deployed in a container. Instead, a direct interface such as
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bond0_can_be_specified_via_the_host_bind_override_override_when_defining" title="bond0 can be specified via the "host_bind_override" override when defining" class="md-nav__link">
    bond0 can be specified via the "host_bind_override" override when defining
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#provider_networks" title="provider networks." class="md-nav__link">
    provider networks.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#auto_br-vlan" title="auto br-vlan" class="md-nav__link">
    auto br-vlan
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iface_br-vlan_inet_manual" title="iface br-vlan inet manual" class="md-nav__link">
    iface br-vlan inet manual
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bridge_stp_off" title="bridge_stp off" class="md-nav__link">
    bridge_stp off
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bridge_waitport_0" title="bridge_waitport 0" class="md-nav__link">
    bridge_waitport 0
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bridge_fd_0" title="bridge_fd 0" class="md-nav__link">
    bridge_fd 0
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bridge_ports_bond0" title="bridge_ports bond0" class="md-nav__link">
    bridge_ports bond0
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compute1_network_vlan_bridge" title="compute1 Network VLAN bridge" class="md-nav__link">
    compute1 Network VLAN bridge
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#auto_br-vlan_1" title="auto br-vlan" class="md-nav__link">
    auto br-vlan
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iface_br-vlan_inet_manual_1" title="iface br-vlan inet manual" class="md-nav__link">
    iface br-vlan inet manual
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bridge_stp_off_1" title="bridge_stp off" class="md-nav__link">
    bridge_stp off
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bridge_waitport_1" title="bridge_waitport 0" class="md-nav__link">
    bridge_waitport 0
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bridge_fd_1" title="bridge_fd 0" class="md-nav__link">
    bridge_fd 0
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#storage_bridge_optional" title="Storage bridge (optional)" class="md-nav__link">
    Storage bridge (optional)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#only_the_compute_and_storage_nodes_must_have_an_ip_address" title="Only the COMPUTE and STORAGE nodes must have an IP address" class="md-nav__link">
    Only the COMPUTE and STORAGE nodes must have an IP address
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#on_this_bridge_when_used_by_infrastructure_nodes_the" title="on this bridge. When used by infrastructure nodes, the" class="md-nav__link">
    on this bridge. When used by infrastructure nodes, the
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ip_addresses_are_assigned_to_containers_which_use_this" title="IP addresses are assigned to containers which use this" class="md-nav__link">
    IP addresses are assigned to containers which use this
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bridge" title="bridge." class="md-nav__link">
    bridge.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compute1_storage_bridge" title="compute1 Storage bridge" class="md-nav__link">
    compute1 Storage bridge
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#auto_br-storage" title="auto br-storage" class="md-nav__link">
    auto br-storage
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iface_br-storage_inet_static" title="iface br-storage inet static" class="md-nav__link">
    iface br-storage inet static
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bridge_stp_offauto_br-storage" title="bridge_stp off#auto br-storage" class="md-nav__link">
    bridge_stp off#auto br-storage
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bridge_waitport_2" title="bridge_waitport 0" class="md-nav__link">
    bridge_waitport 0
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bridge_fd_2" title="bridge_fd 0" class="md-nav__link">
    bridge_fd 0
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bridge_ports_bond020" title="bridge_ports bond0.20" class="md-nav__link">
    bridge_ports bond0.20
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#address_1722924416" title="address 172.29.244.16" class="md-nav__link">
    address 172.29.244.16
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#netmask_2552552520" title="netmask 255.255.252.0" class="md-nav__link">
    netmask 255.255.252.0
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/ostackdoc/ostackdoc-docs/edit/master/docs/network-architectures.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>Network Architectures</h1>
                
                <p>OpenStack-Ansible supports a number of different network architectures, and can be deployed using a single network interface for non-production workloads or using multiple network interfaces or bonded interfaces for production workloads.</p>
<p>Our OpenStack-Ansible production environment reference architectures in this guide segments traffic using VLANs across multiple network interfaces or bonds.</p>
<p>The default networks used in an OpenStack-Ansible in this deployment can be observed in the following table:</p>
<table>
<thead>
<tr>
<th><strong>Network</strong></th>
<th><strong>CIDR</strong></th>
<th><strong>VLAN</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Management Network</td>
<td><code>172.25.236.0/22</code></td>
<td><code>10</code></td>
</tr>
<tr>
<td>Overlay Network</td>
<td><code>172.25.240.0/22</code></td>
<td><code>30</code></td>
</tr>
<tr>
<td>Storage Network</td>
<td><code>172.29.244.0/22</code></td>
<td><code>20</code></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Unless, if we specifically do mention about a new network architecture  we will be referring to the same network architecture above through out this document.</p>
</div>
<h3 id="management_network">Management Network<a class="headerlink" href="#management_network" title="Permanent link">&para;</a></h3>
<p>The <code>Management Network</code>, also referred to as the <code>Container network</code>, provides management of and communication between the infrastructure and OpenStack services running in containers or on metal. The management network uses a dedicated <code>VLAN</code> typically connected to the <code>br-mgmt</code> bridge, and may also be used as the primary interface used to interact with the server via <code>SSH</code>.</p>
<h3 id="overlay_network">Overlay Network<a class="headerlink" href="#overlay_network" title="Permanent link">&para;</a></h3>
<p>The <code>Overlay Network</code>, also referred to as the <code>Tunnel Network</code>, provides connectivity between hosts for the purpose of <code>tunneling</code> encapsulated traffic using <code>VXLAN</code>, <code>GRE</code>, or other protocols. The <code>Overlay Network</code> uses a dedicated <code>VLAN</code> typically connected to the <code>br-vxlan</code> bridge.</p>
<h3 id="storage_network">Storage Network<a class="headerlink" href="#storage_network" title="Permanent link">&para;</a></h3>
<p>The <code>Storage Network</code> provides segregated access to Block Storage from OpenStack services such as <code>Cinder, Glance, Ceph</code>, etc.. The <code>Storage Network</code> uses a dedicated <code>VLAN</code> typically connected to the <code>br-storage</code> bridge.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code>CIDRs</code> and <code>VLANs</code> listed for each network are examples and may be different in your environment.</p>
</div>
<p>Additional <code>VLANs</code> may be required for the following purposes:</p>
<ul>
<li>External provider networks for <code>Floating IPs</code> and instances</li>
<li>Self-service <code>Project/Tenant</code> networks for instances</li>
<li>Other OpenStack services</li>
</ul>
<h3 id="network_interfaces">Network Interfaces<a class="headerlink" href="#network_interfaces" title="Permanent link">&para;</a></h3>
<h4 id="single_interface_or_bond">Single Interface or Bond<a class="headerlink" href="#single_interface_or_bond" title="Permanent link">&para;</a></h4>
<p>OpenStack-Ansible supports the use of a <code>single</code> interface or set of <code>bonded</code> interfaces that carry <code>traffic</code> for OpenStack services as well as instances.</p>
<p>The following diagram demonstrates hosts using a single interface:</p>
<p><img alt="" src="../img/single-interface.jpg" /></p>
<p>The following diagram demonstrates hosts using a single bond:</p>
<p><img alt="" src="../img/single-bond-interface.jpg" /></p>
<h4 id="single_bond_sample_network_configuration">Single Bond Sample Network Configuration<a class="headerlink" href="#single_bond_sample_network_configuration" title="Permanent link">&para;</a></h4>
<p>Each host will require the correct network bridges to be implemented.</p>
<p>The following is the <code>/etc/network/interfaces</code> file for <code>infra1</code> control plane host using a single bond in a Ubuntu host.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If your environment does not have eth0, but instead has p1p1 or some other interface name, ensure that all references to eth0 in all configuration files are replaced with the appropriate name. The same applies to additional network interfaces.</p>
<p>Please refer to <a href="/prepare-deployment-host/#configure_the_network_interfaces">Configuring Network Interfaces</a> for more details.</p>
</div>
<div class="codehilite"><pre><span></span>!!! Important

    This is a multi-NIC bonded configuration to implement the required bridges for OpenStack-Ansible. This illustrates the configuration of the first Infrastructure host `infra1` and the IP addresses assigned should be adapted for implementation on the other hosts.  After implementing this configuration, the host will need to be rebooted.

    Assuming that eth0/1 and eth2/3 are dual port NIC&#39;s we pair `eth0` with `eth2` for increased resiliency in the case of one interface card failing.
</pre></div>


<p>auto eth0</p>
<p>iface eth0 inet manual
    bond-master bond0
    bond-primary eth0</p>
<p>auto eth1
iface eth1 inet manual</p>
<p>auto eth2
iface eth2 inet manual
    bond-master bond0</p>
<p>auto eth3
iface eth3 inet manual</p>
<h2 id="create_a_bonded_interface_note_that_the_bond-slaves_is_set_to_none_this">Create a bonded interface. Note that the "bond-slaves" is set to none. This<a class="headerlink" href="#create_a_bonded_interface_note_that_the_bond-slaves_is_set_to_none_this" title="Permanent link">&para;</a></h2>
<h2 id="is_because_the_bond-master_has_already_been_set_in_the_raw_interfaces_for">is because the bond-master has already been set in the raw interfaces for<a class="headerlink" href="#is_because_the_bond-master_has_already_been_set_in_the_raw_interfaces_for" title="Permanent link">&para;</a></h2>
<h2 id="the_new_bond0">the new bond0.<a class="headerlink" href="#the_new_bond0" title="Permanent link">&para;</a></h2>
<p>auto bond0
iface bond0 inet manual
    bond-slaves none
    bond-mode active-backup
    bond-miimon 100
    bond-downdelay 200
    bond-updelay 200</p>
<h2 id="containerhost_management_vlan_interface">Container/Host management VLAN interface<a class="headerlink" href="#containerhost_management_vlan_interface" title="Permanent link">&para;</a></h2>
<p>auto bond0.10
iface bond0.10 inet manual
    vlan-raw-device bond0</p>
<h2 id="openstack_networking_vxlan_tunneloverlay_vlan_interface">OpenStack Networking VXLAN (tunnel/overlay) VLAN interface<a class="headerlink" href="#openstack_networking_vxlan_tunneloverlay_vlan_interface" title="Permanent link">&para;</a></h2>
<p>auto bond0.30
iface bond0.30 inet manual
    vlan-raw-device bond0</p>
<h2 id="storage_network_vlan_interface_optional">Storage network VLAN interface (optional)<a class="headerlink" href="#storage_network_vlan_interface_optional" title="Permanent link">&para;</a></h2>
<p>auto bond0.20
iface bond0.20 inet manual</p>
<h2 id="containerhost_management_bridge">Container/Host management bridge<a class="headerlink" href="#containerhost_management_bridge" title="Permanent link">&para;</a></h2>
<p>auto br-mgmt
iface br-mgmt inet static
    bridge_stp off
    bridge_waitport 0
    bridge_fd 0
    bridge_ports bond0.10
    address 172.29.236.11
    netmask 255.255.252.0
    gateway 172.29.236.1
    dns-nameservers 8.8.8.8 8.8.4.4</p>
<h2 id="openstack_networking_vxlan_tunneloverlay_bridge">OpenStack Networking VXLAN (tunnel/overlay) bridge<a class="headerlink" href="#openstack_networking_vxlan_tunneloverlay_bridge" title="Permanent link">&para;</a></h2>
<h2 id="_1"><a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<h2 id="nodes_hosting_neutron_agents_must_have_an_ip_address_on_this_interface">Nodes hosting Neutron agents must have an IP address on this interface,<a class="headerlink" href="#nodes_hosting_neutron_agents_must_have_an_ip_address_on_this_interface" title="Permanent link">&para;</a></h2>
<h2 id="including_compute_network_and_collapsed_infranetwork_nodes">including COMPUTE, NETWORK, and collapsed INFRA/NETWORK nodes.<a class="headerlink" href="#including_compute_network_and_collapsed_infranetwork_nodes" title="Permanent link">&para;</a></h2>
<h2 id="_2"><a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<p>auto br-vxlan
iface br-vxlan inet static
    bridge_stp off
    bridge_waitport 0
    bridge_fd 0
    bridge_ports bond0.30
    address 172.29.240.16
    netmask 255.255.252.0</p>
<h2 id="openstack_networking_vlan_bridge">OpenStack Networking VLAN bridge<a class="headerlink" href="#openstack_networking_vlan_bridge" title="Permanent link">&para;</a></h2>
<h2 id="_3"><a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
<h2 id="the_br-vlan_bridge_is_no_longer_necessary_for_deployments_unless_neutron">The "br-vlan" bridge is no longer necessary for deployments unless Neutron<a class="headerlink" href="#the_br-vlan_bridge_is_no_longer_necessary_for_deployments_unless_neutron" title="Permanent link">&para;</a></h2>
<h2 id="agents_are_deployed_in_a_container_instead_a_direct_interface_such_as">agents are deployed in a container. Instead, a direct interface such as<a class="headerlink" href="#agents_are_deployed_in_a_container_instead_a_direct_interface_such_as" title="Permanent link">&para;</a></h2>
<h2 id="bond0_can_be_specified_via_the_host_bind_override_override_when_defining">bond0 can be specified via the "host_bind_override" override when defining<a class="headerlink" href="#bond0_can_be_specified_via_the_host_bind_override_override_when_defining" title="Permanent link">&para;</a></h2>
<h2 id="provider_networks">provider networks.<a class="headerlink" href="#provider_networks" title="Permanent link">&para;</a></h2>
<h2 id="_4"><a class="headerlink" href="#_4" title="Permanent link">&para;</a></h2>
<h2 id="auto_br-vlan">auto br-vlan<a class="headerlink" href="#auto_br-vlan" title="Permanent link">&para;</a></h2>
<h2 id="iface_br-vlan_inet_manual">iface br-vlan inet manual<a class="headerlink" href="#iface_br-vlan_inet_manual" title="Permanent link">&para;</a></h2>
<h2 id="bridge_stp_off">bridge_stp off<a class="headerlink" href="#bridge_stp_off" title="Permanent link">&para;</a></h2>
<h2 id="bridge_waitport_0">bridge_waitport 0<a class="headerlink" href="#bridge_waitport_0" title="Permanent link">&para;</a></h2>
<h2 id="bridge_fd_0">bridge_fd 0<a class="headerlink" href="#bridge_fd_0" title="Permanent link">&para;</a></h2>
<h2 id="bridge_ports_bond0">bridge_ports bond0<a class="headerlink" href="#bridge_ports_bond0" title="Permanent link">&para;</a></h2>
<h2 id="compute1_network_vlan_bridge">compute1 Network VLAN bridge<a class="headerlink" href="#compute1_network_vlan_bridge" title="Permanent link">&para;</a></h2>
<h2 id="auto_br-vlan_1">auto br-vlan<a class="headerlink" href="#auto_br-vlan_1" title="Permanent link">&para;</a></h2>
<h2 id="iface_br-vlan_inet_manual_1">iface br-vlan inet manual<a class="headerlink" href="#iface_br-vlan_inet_manual_1" title="Permanent link">&para;</a></h2>
<h2 id="bridge_stp_off_1">bridge_stp off<a class="headerlink" href="#bridge_stp_off_1" title="Permanent link">&para;</a></h2>
<h2 id="bridge_waitport_1">bridge_waitport 0<a class="headerlink" href="#bridge_waitport_1" title="Permanent link">&para;</a></h2>
<h2 id="bridge_fd_1">bridge_fd 0<a class="headerlink" href="#bridge_fd_1" title="Permanent link">&para;</a></h2>
<h2 id="_5"><a class="headerlink" href="#_5" title="Permanent link">&para;</a></h2>
<h2 id="storage_bridge_optional">Storage bridge (optional)<a class="headerlink" href="#storage_bridge_optional" title="Permanent link">&para;</a></h2>
<h2 id="_6"><a class="headerlink" href="#_6" title="Permanent link">&para;</a></h2>
<h2 id="only_the_compute_and_storage_nodes_must_have_an_ip_address">Only the COMPUTE and STORAGE nodes must have an IP address<a class="headerlink" href="#only_the_compute_and_storage_nodes_must_have_an_ip_address" title="Permanent link">&para;</a></h2>
<h2 id="on_this_bridge_when_used_by_infrastructure_nodes_the">on this bridge. When used by infrastructure nodes, the<a class="headerlink" href="#on_this_bridge_when_used_by_infrastructure_nodes_the" title="Permanent link">&para;</a></h2>
<h2 id="ip_addresses_are_assigned_to_containers_which_use_this">IP addresses are assigned to containers which use this<a class="headerlink" href="#ip_addresses_are_assigned_to_containers_which_use_this" title="Permanent link">&para;</a></h2>
<h2 id="bridge">bridge.<a class="headerlink" href="#bridge" title="Permanent link">&para;</a></h2>
<h2 id="_7"><a class="headerlink" href="#_7" title="Permanent link">&para;</a></h2>
<p>auto br-storage
iface br-storage inet manual
    bridge_stp off
    bridge_waitport 0
    bridge_fd 0
    bridge_ports bond0.20</p>
<h2 id="compute1_storage_bridge">compute1 Storage bridge<a class="headerlink" href="#compute1_storage_bridge" title="Permanent link">&para;</a></h2>
<h2 id="auto_br-storage">auto br-storage<a class="headerlink" href="#auto_br-storage" title="Permanent link">&para;</a></h2>
<h2 id="iface_br-storage_inet_static">iface br-storage inet static<a class="headerlink" href="#iface_br-storage_inet_static" title="Permanent link">&para;</a></h2>
<h2 id="bridge_stp_offauto_br-storage">bridge_stp off#auto br-storage<a class="headerlink" href="#bridge_stp_offauto_br-storage" title="Permanent link">&para;</a></h2>
<h2 id="bridge_waitport_2">bridge_waitport 0<a class="headerlink" href="#bridge_waitport_2" title="Permanent link">&para;</a></h2>
<h2 id="bridge_fd_2">bridge_fd 0<a class="headerlink" href="#bridge_fd_2" title="Permanent link">&para;</a></h2>
<h2 id="bridge_ports_bond020">bridge_ports bond0.20<a class="headerlink" href="#bridge_ports_bond020" title="Permanent link">&para;</a></h2>
<h2 id="address_1722924416">address 172.29.244.16<a class="headerlink" href="#address_1722924416" title="Permanent link">&para;</a></h2>
<h2 id="netmask_2552552520">netmask 255.255.252.0<a class="headerlink" href="#netmask_2552552520" title="Permanent link">&para;</a></h2>
<p>```</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../overview/" title="Overview" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Overview
              </span>
            </div>
          </a>
        
        
          <a href="../prepare-deployment-host/" title="Prepare Deployment Host" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Prepare Deployment Host
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2018 - 2019 Chinthaka Deshapriya
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/ostackdoc" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://twitter.com/ostackdoc" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="https://linkedin.com/in/ostackdoc" class="md-footer-social__link fa fa-linkedin"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.d9aa80ab.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
  </body>
</html>