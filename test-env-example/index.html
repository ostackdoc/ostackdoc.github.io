



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Guide for openstack-ansible Deployers">
      
      
        <link rel="canonical" href="https://ostackdoc.github.io/test-env-example/">
      
      
        <meta name="author" content="Chinthaka Deshapriya">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.0.2">
    
    
      
        <title>Test Environment Example - Openstack Ansible Deployment Guide</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.982221ab.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.224b79ff.css">
      
      
        
        
        <meta name="theme-color" content="#3f51b5">
      
    
    
      <script src="../assets/javascripts/modernizr.1f0bcf2b.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
      <link rel="manifest" href="../manifest.webmanifest">
    
    
      <link rel="stylesheet" href="../extra.css">
    
    
      
        
<script>
  window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date
  /* Setup integration and send page view */
  ga("create", "UA-136248088-1", "ostackdoc.github.io")
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")
  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  })
</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#configuring_the_network" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://ostackdoc.github.io" title="Openstack Ansible Deployment Guide" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Openstack Ansible Deployment Guide
            </span>
            <span class="md-header-nav__topic">
              Test Environment Example
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/ostackdoc/ostackdoc-docs/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    ostackdoc/ostackdoc-docs
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://ostackdoc.github.io" title="Openstack Ansible Deployment Guide" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Openstack Ansible Deployment Guide
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/ostackdoc/ostackdoc-docs/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    ostackdoc/ostackdoc-docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../network-architectures/" title="Network Architectures" class="md-nav__link">
      Network Architectures
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../prepare-deployment-host/" title="Prepare Deployment Host" class="md-nav__link">
      Prepare Deployment Host
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../prepare-the-target-hosts/" title="Prepare the Target Hosts" class="md-nav__link">
      Prepare the Target Hosts
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Test Environment Example
      </label>
    
    <a href="./" title="Test Environment Example" class="md-nav__link md-nav__link--active">
      Test Environment Example
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#configuring_the_network" title="Configuring the Network" class="md-nav__link">
    Configuring the Network
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#host_network_bridges_information" title="Host Network Bridges Information" class="md-nav__link">
    Host Network Bridges Information
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lxc_internal_lxcbr0" title="LXC internal: lxcbr0" class="md-nav__link">
    LXC internal: lxcbr0
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#container_managementbr-mgmt" title="Container management:br-mgmt" class="md-nav__link">
    Container management:br-mgmt
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#storagebr-storage" title="Storage:br-storage" class="md-nav__link">
    Storage:br-storage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#openstack_networking_tunnelbr-vxlan" title="OpenStack Networking tunnel:br-vxlan" class="md-nav__link">
    OpenStack Networking tunnel:br-vxlan
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#openstack_networking_providerbr-vlan" title="OpenStack Networking provider:br-vlan" class="md-nav__link">
    OpenStack Networking provider:br-vlan
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_architecture" title="Network Architecture" class="md-nav__link">
    Network Architecture
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_cidrvlan_assignments" title="Network CIDR/VLAN Assignments" class="md-nav__link">
    Network CIDR/VLAN Assignments
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ip_assignments" title="IP Assignments" class="md-nav__link">
    IP Assignments
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuring_the_operating_system" title="Configuring the Operating System" class="md-nav__link">
    Configuring the Operating System
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#install_the_operating_system" title="Install the Operating System" class="md-nav__link">
    Install the Operating System
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#alternative_ubuntu_server_installer" title="Alternative Ubuntu Server installer" class="md-nav__link">
    Alternative Ubuntu Server installer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#suggested_partitions_scheme_for_openstack_nodes" title="Suggested Partitions Scheme for OpenStack Nodes." class="md-nav__link">
    Suggested Partitions Scheme for OpenStack Nodes.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure_ubuntu" title="Configure Ubuntu" class="md-nav__link">
    Configure Ubuntu
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#this_file_describes_the_network_interfaces_available_on_your_system" title="This file describes the network interfaces available on your system" class="md-nav__link">
    This file describes the network interfaces available on your system
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#for_more_information_see_netplan5" title="For more information, see netplan(5)." class="md-nav__link">
    For more information, see netplan(5).
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#physical_interfaces" title="Physical interfaces" class="md-nav__link">
    Physical interfaces
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#containerhost_management_vlan_interface" title="Container/Host management VLAN interface" class="md-nav__link">
    Container/Host management VLAN interface
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openstack_networking_vxlan_tunneloverlay_vlan_interface" title="OpenStack Networking VXLAN (tunnel/overlay) VLAN interface" class="md-nav__link">
    OpenStack Networking VXLAN (tunnel/overlay) VLAN interface
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#storage_network_vlan_interface_optional" title="Storage network VLAN interface (optional)" class="md-nav__link">
    Storage network VLAN interface (optional)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#containerhost_management_bridge" title="Container/Host management bridge" class="md-nav__link">
    Container/Host management bridge
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bind_the_internal_lb_vip_as_we_run_haproxy_without_keepalived" title="Bind the Internal LB VIP as we run haproxy without keepalived" class="md-nav__link">
    Bind the Internal LB VIP as we run haproxy without keepalived
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bind_the_external_lb_vip_as_we_run_haproxy_without_keepalived" title="Bind the External LB VIP as we run haproxy without keepalived" class="md-nav__link">
    Bind the External LB VIP as we run haproxy without keepalived
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#external_network_access_for_floating_ip" title="External Network access for Floating IP" class="md-nav__link">
    External Network access for Floating IP
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openstack_networking_vxlan_tunneloverlay_bridge" title="OpenStack Networking VXLAN (tunnel/overlay) bridge" class="md-nav__link">
    OpenStack Networking VXLAN (tunnel/overlay) bridge
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the_compute_network_and_infra_nodes_must_have_an_ip_address" title="The COMPUTE, NETWORK and INFRA nodes must have an IP address" class="md-nav__link">
    The COMPUTE, NETWORK and INFRA nodes must have an IP address
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#on_this_bridge" title="on this bridge." class="md-nav__link">
    on this bridge.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openstack_networking_vlan_bridge" title="OpenStack Networking VLAN bridge" class="md-nav__link">
    OpenStack Networking VLAN bridge
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#storage_bridge_optional" title="Storage bridge (optional)" class="md-nav__link">
    Storage bridge (optional)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#only_the_compute_and_storage_nodes_must_have_an_ip_address" title="Only the COMPUTE and STORAGE nodes must have an IP address" class="md-nav__link">
    Only the COMPUTE and STORAGE nodes must have an IP address
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#on_this_bridge_when_used_by_infrastructure_nodes_the" title="on this bridge. When used by infrastructure nodes, the" class="md-nav__link">
    on this bridge. When used by infrastructure nodes, the
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ip_addresses_are_assigned_to_containers_which_use_this" title="IP addresses are assigned to containers which use this" class="md-nav__link">
    IP addresses are assigned to containers which use this
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bridgedeploying_and_customizing_openstack_mitaka_with_openstack-ansible" title="bridge.Deploying and customizing OpenStack Mitaka with openstack-ansible" class="md-nav__link">
    bridge.Deploying and customizing OpenStack Mitaka with openstack-ansible
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#storage_bridge" title="Storage bridge" class="md-nav__link">
    Storage bridge
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#physical_interfaces_1" title="Physical interfaces" class="md-nav__link">
    Physical interfaces
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#containerhost_management_vlan_interface_1" title="Container/Host management VLAN interface" class="md-nav__link">
    Container/Host management VLAN interface
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openstack_networking_vxlan_tunneloverlay_vlan_interface_1" title="OpenStack Networking VXLAN (tunnel/overlay) VLAN interface" class="md-nav__link">
    OpenStack Networking VXLAN (tunnel/overlay) VLAN interface
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#storage_network_vlan_interface_optional_1" title="Storage network VLAN interface (optional)" class="md-nav__link">
    Storage network VLAN interface (optional)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#containerhost_management_bridge_1" title="Container/Host management bridge" class="md-nav__link">
    Container/Host management bridge
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#external_network_access_for_floating_ip_1" title="External Network access for Floating IP" class="md-nav__link">
    External Network access for Floating IP
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openstack_networking_vxlan_tunneloverlay_bridge_1" title="OpenStack Networking VXLAN (tunnel/overlay) bridge" class="md-nav__link">
    OpenStack Networking VXLAN (tunnel/overlay) bridge
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the_compute_network_and_infra_nodes_must_have_an_ip_address_1" title="The COMPUTE, NETWORK and INFRA nodes must have an IP address" class="md-nav__link">
    The COMPUTE, NETWORK and INFRA nodes must have an IP address
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#on_this_bridge_1" title="on this bridge." class="md-nav__link">
    on this bridge.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openstack_networking_vlan_bridge_1" title="OpenStack Networking VLAN bridge" class="md-nav__link">
    OpenStack Networking VLAN bridge
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#for_tenant_vlan_support_create_a_veth_pair_to_be_used_when_the_neutron" title="For tenant vlan support, create a veth pair to be used when the neutron" class="md-nav__link">
    For tenant vlan support, create a veth pair to be used when the neutron
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agent_is_not_containerized_on_the_compute_hosts_eth12_is_the_value_used_on" title="agent is not containerized on the compute hosts. 'eth12' is the value used on" class="md-nav__link">
    agent is not containerized on the compute hosts. 'eth12' is the value used on
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the_host_bind_override_parameter_of_the_br-vlan_network_section_of_the" title="the host_bind_override parameter of the br-vlan network section of the" class="md-nav__link">
    the host_bind_override parameter of the br-vlan network section of the
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openstack_user_config_example_file_the_veth_peer_name_must_match_the_value" title="openstack_user_config example file. The veth peer name must match the value" class="md-nav__link">
    openstack_user_config example file. The veth peer name must match the value
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#specified_on_the_host_bind_override_parameter" title="specified on the host_bind_override parameter." class="md-nav__link">
    specified on the host_bind_override parameter.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#when_the_neutron_agent_is_containerized_it_will_use_the_container_interface" title="When the neutron agent is containerized it will use the container_interface" class="md-nav__link">
    When the neutron agent is containerized it will use the container_interface
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#value_of_the_br-vlan_network_which_is_also_the_same_eth12_value" title="value of the br-vlan network, which is also the same 'eth12' value." class="md-nav__link">
    value of the br-vlan network, which is also the same 'eth12' value.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create_veth_pair_do_not_abort_if_already_exists" title="Create veth pair, do not abort if already exists" class="md-nav__link">
    Create veth pair, do not abort if already exists
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pre-up_ip_link_add_br-vlan-veth_type_veth_peer_name_eth12_true" title="pre-up ip link add br-vlan-veth type veth peer name eth12 || true" class="md-nav__link">
    pre-up ip link add br-vlan-veth type veth peer name eth12 || true
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#set_both_ends_up" title="Set both ends UP" class="md-nav__link">
    Set both ends UP
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pre-up_ip_link_set_br-vlan-veth_up" title="pre-up ip link set br-vlan-veth up" class="md-nav__link">
    pre-up ip link set br-vlan-veth up
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pre-up_ip_link_set_eth12_up" title="pre-up ip link set eth12 up" class="md-nav__link">
    pre-up ip link set eth12 up
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#delete_veth_pair_on_down" title="Delete veth pair on DOWN" class="md-nav__link">
    Delete veth pair on DOWN
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#post-down_ip_link_del_br-vlan-veth_true" title="post-down ip link del br-vlan-veth || true" class="md-nav__link">
    post-down ip link del br-vlan-veth || true
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bridge_ports_eth0_br-vlan-veth" title="bridge_ports eth0 br-vlan-veth" class="md-nav__link">
    bridge_ports eth0 br-vlan-veth
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#storage_bridge_optional_1" title="Storage bridge (optional)" class="md-nav__link">
    Storage bridge (optional)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#only_the_compute_and_storage_nodes_must_have_an_ip_address_1" title="Only the COMPUTE and STORAGE nodes must have an IP address" class="md-nav__link">
    Only the COMPUTE and STORAGE nodes must have an IP address
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#on_this_bridge_when_used_by_infrastructure_nodes_the_1" title="on this bridge. When used by infrastructure nodes, the" class="md-nav__link">
    on this bridge. When used by infrastructure nodes, the
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ip_addresses_are_assigned_to_containers_which_use_this_1" title="IP addresses are assigned to containers which use this" class="md-nav__link">
    IP addresses are assigned to containers which use this
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bridgedeploying_and_customizing_openstack_mitaka_with_openstack-ansible_1" title="bridge.Deploying and customizing OpenStack Mitaka with openstack-ansible" class="md-nav__link">
    bridge.Deploying and customizing OpenStack Mitaka with openstack-ansible
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#storage_bridge_1" title="Storage bridge" class="md-nav__link">
    Storage bridge
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#physical_interfaces_2" title="Physical interfaces" class="md-nav__link">
    Physical interfaces
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#containerhost_management_vlan_interface_2" title="Container/Host management VLAN interface" class="md-nav__link">
    Container/Host management VLAN interface
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openstack_networking_vxlan_tunneloverlay_vlan_interface_2" title="OpenStack Networking VXLAN (tunnel/overlay) VLAN interface" class="md-nav__link">
    OpenStack Networking VXLAN (tunnel/overlay) VLAN interface
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#storage_network_vlan_interface_optional_2" title="Storage network VLAN interface (optional)" class="md-nav__link">
    Storage network VLAN interface (optional)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#containerhost_management_bridge_2" title="Container/Host management bridge" class="md-nav__link">
    Container/Host management bridge
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#storage_bridge_2" title="Storage bridge" class="md-nav__link">
    Storage bridge
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuring_the_storage" title="Configuring The Storage" class="md-nav__link">
    Configuring The Storage
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#setup_dns_resolver" title="Setup DNS Resolver" class="md-nav__link">
    Setup DNS Resolver
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setup_nat_gateway" title="Setup NAT Gateway." class="md-nav__link">
    Setup NAT Gateway.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setup_openstack_ansible_host" title="Setup  OpenStack Ansible Host" class="md-nav__link">
    Setup  OpenStack Ansible Host
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#infrastructure" title="Infrastructure" class="md-nav__link">
    Infrastructure
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#galera_memcache_rabbitmq_utility" title="galera, memcache, rabbitmq, utility" class="md-nav__link">
    galera, memcache, rabbitmq, utility
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#repository_apt_cache_python_packages_etc" title="repository (apt cache, python packages, etc)" class="md-nav__link">
    repository (apt cache, python packages, etc)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#load_balancer" title="load balancer" class="md-nav__link">
    load balancer
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#openstack" title="OpenStack" class="md-nav__link">
    OpenStack
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#keystone" title="keystone" class="md-nav__link">
    keystone
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cinder_api_services" title="cinder api services" class="md-nav__link">
    cinder api services
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#glance" title="glance" class="md-nav__link">
    glance
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nova_api_conductor_etc_services" title="nova api, conductor, etc services" class="md-nav__link">
    nova api, conductor, etc services
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#heat" title="heat" class="md-nav__link">
    heat
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#horizon" title="horizon" class="md-nav__link">
    horizon
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#neutron_server_agents_l3_etc" title="neutron server, agents (L3, etc)" class="md-nav__link">
    neutron server, agents (L3, etc)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nova_hypervisors" title="nova hypervisors" class="md-nav__link">
    nova hypervisors
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cinder_storage_host_lvm-backed" title="cinder storage host (LVM-backed)" class="md-nav__link">
    cinder storage host (LVM-backed)
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Preparing OpenStack Nodes
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Preparing OpenStack Nodes
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../install-node-os/" title="Installing Node OS" class="md-nav__link">
      Installing Node OS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../configure-node-network/" title="Configuring Node Network" class="md-nav__link">
      Configuring Node Network
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#configuring_the_network" title="Configuring the Network" class="md-nav__link">
    Configuring the Network
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#host_network_bridges_information" title="Host Network Bridges Information" class="md-nav__link">
    Host Network Bridges Information
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lxc_internal_lxcbr0" title="LXC internal: lxcbr0" class="md-nav__link">
    LXC internal: lxcbr0
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#container_managementbr-mgmt" title="Container management:br-mgmt" class="md-nav__link">
    Container management:br-mgmt
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#storagebr-storage" title="Storage:br-storage" class="md-nav__link">
    Storage:br-storage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#openstack_networking_tunnelbr-vxlan" title="OpenStack Networking tunnel:br-vxlan" class="md-nav__link">
    OpenStack Networking tunnel:br-vxlan
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#openstack_networking_providerbr-vlan" title="OpenStack Networking provider:br-vlan" class="md-nav__link">
    OpenStack Networking provider:br-vlan
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_architecture" title="Network Architecture" class="md-nav__link">
    Network Architecture
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_cidrvlan_assignments" title="Network CIDR/VLAN Assignments" class="md-nav__link">
    Network CIDR/VLAN Assignments
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ip_assignments" title="IP Assignments" class="md-nav__link">
    IP Assignments
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuring_the_operating_system" title="Configuring the Operating System" class="md-nav__link">
    Configuring the Operating System
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#install_the_operating_system" title="Install the Operating System" class="md-nav__link">
    Install the Operating System
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#alternative_ubuntu_server_installer" title="Alternative Ubuntu Server installer" class="md-nav__link">
    Alternative Ubuntu Server installer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#suggested_partitions_scheme_for_openstack_nodes" title="Suggested Partitions Scheme for OpenStack Nodes." class="md-nav__link">
    Suggested Partitions Scheme for OpenStack Nodes.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure_ubuntu" title="Configure Ubuntu" class="md-nav__link">
    Configure Ubuntu
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#this_file_describes_the_network_interfaces_available_on_your_system" title="This file describes the network interfaces available on your system" class="md-nav__link">
    This file describes the network interfaces available on your system
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#for_more_information_see_netplan5" title="For more information, see netplan(5)." class="md-nav__link">
    For more information, see netplan(5).
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#physical_interfaces" title="Physical interfaces" class="md-nav__link">
    Physical interfaces
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#containerhost_management_vlan_interface" title="Container/Host management VLAN interface" class="md-nav__link">
    Container/Host management VLAN interface
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openstack_networking_vxlan_tunneloverlay_vlan_interface" title="OpenStack Networking VXLAN (tunnel/overlay) VLAN interface" class="md-nav__link">
    OpenStack Networking VXLAN (tunnel/overlay) VLAN interface
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#storage_network_vlan_interface_optional" title="Storage network VLAN interface (optional)" class="md-nav__link">
    Storage network VLAN interface (optional)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#containerhost_management_bridge" title="Container/Host management bridge" class="md-nav__link">
    Container/Host management bridge
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bind_the_internal_lb_vip_as_we_run_haproxy_without_keepalived" title="Bind the Internal LB VIP as we run haproxy without keepalived" class="md-nav__link">
    Bind the Internal LB VIP as we run haproxy without keepalived
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bind_the_external_lb_vip_as_we_run_haproxy_without_keepalived" title="Bind the External LB VIP as we run haproxy without keepalived" class="md-nav__link">
    Bind the External LB VIP as we run haproxy without keepalived
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#external_network_access_for_floating_ip" title="External Network access for Floating IP" class="md-nav__link">
    External Network access for Floating IP
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openstack_networking_vxlan_tunneloverlay_bridge" title="OpenStack Networking VXLAN (tunnel/overlay) bridge" class="md-nav__link">
    OpenStack Networking VXLAN (tunnel/overlay) bridge
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the_compute_network_and_infra_nodes_must_have_an_ip_address" title="The COMPUTE, NETWORK and INFRA nodes must have an IP address" class="md-nav__link">
    The COMPUTE, NETWORK and INFRA nodes must have an IP address
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#on_this_bridge" title="on this bridge." class="md-nav__link">
    on this bridge.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openstack_networking_vlan_bridge" title="OpenStack Networking VLAN bridge" class="md-nav__link">
    OpenStack Networking VLAN bridge
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#storage_bridge_optional" title="Storage bridge (optional)" class="md-nav__link">
    Storage bridge (optional)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#only_the_compute_and_storage_nodes_must_have_an_ip_address" title="Only the COMPUTE and STORAGE nodes must have an IP address" class="md-nav__link">
    Only the COMPUTE and STORAGE nodes must have an IP address
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#on_this_bridge_when_used_by_infrastructure_nodes_the" title="on this bridge. When used by infrastructure nodes, the" class="md-nav__link">
    on this bridge. When used by infrastructure nodes, the
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ip_addresses_are_assigned_to_containers_which_use_this" title="IP addresses are assigned to containers which use this" class="md-nav__link">
    IP addresses are assigned to containers which use this
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bridgedeploying_and_customizing_openstack_mitaka_with_openstack-ansible" title="bridge.Deploying and customizing OpenStack Mitaka with openstack-ansible" class="md-nav__link">
    bridge.Deploying and customizing OpenStack Mitaka with openstack-ansible
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#storage_bridge" title="Storage bridge" class="md-nav__link">
    Storage bridge
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#physical_interfaces_1" title="Physical interfaces" class="md-nav__link">
    Physical interfaces
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#containerhost_management_vlan_interface_1" title="Container/Host management VLAN interface" class="md-nav__link">
    Container/Host management VLAN interface
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openstack_networking_vxlan_tunneloverlay_vlan_interface_1" title="OpenStack Networking VXLAN (tunnel/overlay) VLAN interface" class="md-nav__link">
    OpenStack Networking VXLAN (tunnel/overlay) VLAN interface
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#storage_network_vlan_interface_optional_1" title="Storage network VLAN interface (optional)" class="md-nav__link">
    Storage network VLAN interface (optional)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#containerhost_management_bridge_1" title="Container/Host management bridge" class="md-nav__link">
    Container/Host management bridge
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#external_network_access_for_floating_ip_1" title="External Network access for Floating IP" class="md-nav__link">
    External Network access for Floating IP
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openstack_networking_vxlan_tunneloverlay_bridge_1" title="OpenStack Networking VXLAN (tunnel/overlay) bridge" class="md-nav__link">
    OpenStack Networking VXLAN (tunnel/overlay) bridge
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the_compute_network_and_infra_nodes_must_have_an_ip_address_1" title="The COMPUTE, NETWORK and INFRA nodes must have an IP address" class="md-nav__link">
    The COMPUTE, NETWORK and INFRA nodes must have an IP address
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#on_this_bridge_1" title="on this bridge." class="md-nav__link">
    on this bridge.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openstack_networking_vlan_bridge_1" title="OpenStack Networking VLAN bridge" class="md-nav__link">
    OpenStack Networking VLAN bridge
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#for_tenant_vlan_support_create_a_veth_pair_to_be_used_when_the_neutron" title="For tenant vlan support, create a veth pair to be used when the neutron" class="md-nav__link">
    For tenant vlan support, create a veth pair to be used when the neutron
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agent_is_not_containerized_on_the_compute_hosts_eth12_is_the_value_used_on" title="agent is not containerized on the compute hosts. 'eth12' is the value used on" class="md-nav__link">
    agent is not containerized on the compute hosts. 'eth12' is the value used on
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the_host_bind_override_parameter_of_the_br-vlan_network_section_of_the" title="the host_bind_override parameter of the br-vlan network section of the" class="md-nav__link">
    the host_bind_override parameter of the br-vlan network section of the
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openstack_user_config_example_file_the_veth_peer_name_must_match_the_value" title="openstack_user_config example file. The veth peer name must match the value" class="md-nav__link">
    openstack_user_config example file. The veth peer name must match the value
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#specified_on_the_host_bind_override_parameter" title="specified on the host_bind_override parameter." class="md-nav__link">
    specified on the host_bind_override parameter.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#when_the_neutron_agent_is_containerized_it_will_use_the_container_interface" title="When the neutron agent is containerized it will use the container_interface" class="md-nav__link">
    When the neutron agent is containerized it will use the container_interface
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#value_of_the_br-vlan_network_which_is_also_the_same_eth12_value" title="value of the br-vlan network, which is also the same 'eth12' value." class="md-nav__link">
    value of the br-vlan network, which is also the same 'eth12' value.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create_veth_pair_do_not_abort_if_already_exists" title="Create veth pair, do not abort if already exists" class="md-nav__link">
    Create veth pair, do not abort if already exists
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pre-up_ip_link_add_br-vlan-veth_type_veth_peer_name_eth12_true" title="pre-up ip link add br-vlan-veth type veth peer name eth12 || true" class="md-nav__link">
    pre-up ip link add br-vlan-veth type veth peer name eth12 || true
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#set_both_ends_up" title="Set both ends UP" class="md-nav__link">
    Set both ends UP
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pre-up_ip_link_set_br-vlan-veth_up" title="pre-up ip link set br-vlan-veth up" class="md-nav__link">
    pre-up ip link set br-vlan-veth up
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pre-up_ip_link_set_eth12_up" title="pre-up ip link set eth12 up" class="md-nav__link">
    pre-up ip link set eth12 up
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#delete_veth_pair_on_down" title="Delete veth pair on DOWN" class="md-nav__link">
    Delete veth pair on DOWN
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#post-down_ip_link_del_br-vlan-veth_true" title="post-down ip link del br-vlan-veth || true" class="md-nav__link">
    post-down ip link del br-vlan-veth || true
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bridge_ports_eth0_br-vlan-veth" title="bridge_ports eth0 br-vlan-veth" class="md-nav__link">
    bridge_ports eth0 br-vlan-veth
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#storage_bridge_optional_1" title="Storage bridge (optional)" class="md-nav__link">
    Storage bridge (optional)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#only_the_compute_and_storage_nodes_must_have_an_ip_address_1" title="Only the COMPUTE and STORAGE nodes must have an IP address" class="md-nav__link">
    Only the COMPUTE and STORAGE nodes must have an IP address
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#on_this_bridge_when_used_by_infrastructure_nodes_the_1" title="on this bridge. When used by infrastructure nodes, the" class="md-nav__link">
    on this bridge. When used by infrastructure nodes, the
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ip_addresses_are_assigned_to_containers_which_use_this_1" title="IP addresses are assigned to containers which use this" class="md-nav__link">
    IP addresses are assigned to containers which use this
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bridgedeploying_and_customizing_openstack_mitaka_with_openstack-ansible_1" title="bridge.Deploying and customizing OpenStack Mitaka with openstack-ansible" class="md-nav__link">
    bridge.Deploying and customizing OpenStack Mitaka with openstack-ansible
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#storage_bridge_1" title="Storage bridge" class="md-nav__link">
    Storage bridge
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#physical_interfaces_2" title="Physical interfaces" class="md-nav__link">
    Physical interfaces
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#containerhost_management_vlan_interface_2" title="Container/Host management VLAN interface" class="md-nav__link">
    Container/Host management VLAN interface
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openstack_networking_vxlan_tunneloverlay_vlan_interface_2" title="OpenStack Networking VXLAN (tunnel/overlay) VLAN interface" class="md-nav__link">
    OpenStack Networking VXLAN (tunnel/overlay) VLAN interface
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#storage_network_vlan_interface_optional_2" title="Storage network VLAN interface (optional)" class="md-nav__link">
    Storage network VLAN interface (optional)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#containerhost_management_bridge_2" title="Container/Host management bridge" class="md-nav__link">
    Container/Host management bridge
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#storage_bridge_2" title="Storage bridge" class="md-nav__link">
    Storage bridge
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuring_the_storage" title="Configuring The Storage" class="md-nav__link">
    Configuring The Storage
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#setup_dns_resolver" title="Setup DNS Resolver" class="md-nav__link">
    Setup DNS Resolver
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setup_nat_gateway" title="Setup NAT Gateway." class="md-nav__link">
    Setup NAT Gateway.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setup_openstack_ansible_host" title="Setup  OpenStack Ansible Host" class="md-nav__link">
    Setup  OpenStack Ansible Host
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#infrastructure" title="Infrastructure" class="md-nav__link">
    Infrastructure
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#galera_memcache_rabbitmq_utility" title="galera, memcache, rabbitmq, utility" class="md-nav__link">
    galera, memcache, rabbitmq, utility
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#repository_apt_cache_python_packages_etc" title="repository (apt cache, python packages, etc)" class="md-nav__link">
    repository (apt cache, python packages, etc)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#load_balancer" title="load balancer" class="md-nav__link">
    load balancer
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#openstack" title="OpenStack" class="md-nav__link">
    OpenStack
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#keystone" title="keystone" class="md-nav__link">
    keystone
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cinder_api_services" title="cinder api services" class="md-nav__link">
    cinder api services
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#glance" title="glance" class="md-nav__link">
    glance
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nova_api_conductor_etc_services" title="nova api, conductor, etc services" class="md-nav__link">
    nova api, conductor, etc services
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#heat" title="heat" class="md-nav__link">
    heat
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#horizon" title="horizon" class="md-nav__link">
    horizon
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#neutron_server_agents_l3_etc" title="neutron server, agents (L3, etc)" class="md-nav__link">
    neutron server, agents (L3, etc)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nova_hypervisors" title="nova hypervisors" class="md-nav__link">
    nova hypervisors
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cinder_storage_host_lvm-backed" title="cinder storage host (LVM-backed)" class="md-nav__link">
    cinder storage host (LVM-backed)
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/ostackdoc/ostackdoc-docs/edit/master/docs/test-env-example.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>Test Environment Example</h1>
                
                <p>Here is an example test environment for a working OpenStack-Ansible (OSA) deployment with a small number of servers.</p>
<p>This example environment has the following characteristics:</p>
<ul>
<li>One infrastructure node for the <strong>control plane</strong> host (32 vCPU, 128 GB RAM, 2 TB RAID1 HDD)</li>
<li>One compute node (32 vCPU, 128 GB RAM, 2 TB RAID1 HDD)</li>
<li>One Storage node (2 vCPU,  64 GB RAM, 2 TB RAID1 HDD).</li>
<li>Dual Port  Network Interface Card (NIC) for each host</li>
<li>Internet access via the router address <code>192.168.10.1</code> on the Management Network</li>
</ul>
<p>The following figure depicts this test environment and its components.</p>
<p><img alt="zoomify" src="../img/openstack-test-env-v1.jpg" /></p>
<h3 id="configuring_the_network">Configuring the Network<a class="headerlink" href="#configuring_the_network" title="Permanent link">&para;</a></h3>
<p>OpenStack-Ansible uses bridges to connect physical and logical network interfaces on the host to virtual network interfaces within containers. Target hosts need to be configured with the following network bridges:</p>
<table>
<thead>
<tr>
<th><strong>Bridge name</strong></th>
<th><strong>Best configured on</strong></th>
<th><strong>With a static IP</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>br-mgmt</code></td>
<td>On every node</td>
<td>Always</td>
</tr>
<tr>
<td><code>br-storage</code></td>
<td>On every storage node</td>
<td>When component is deployed on metal</td>
</tr>
<tr>
<td></td>
<td>On every compute node</td>
<td>Always</td>
</tr>
<tr>
<td><code>br-vxlan</code></td>
<td>On every network node</td>
<td>When component is deployed on metal</td>
</tr>
<tr>
<td></td>
<td>On every compute node</td>
<td>Always</td>
</tr>
<tr>
<td><code>br-vlan</code></td>
<td>On every network node</td>
<td>Never</td>
</tr>
<tr>
<td></td>
<td>On every compute node</td>
<td>Never</td>
</tr>
</tbody>
</table>
<h3 id="host_network_bridges_information">Host Network Bridges Information<a class="headerlink" href="#host_network_bridges_information" title="Permanent link">&para;</a></h3>
<p>This section describes the Network Bridges used by OpenStack hosts</p>
<h4 id="lxc_internal_lxcbr0">LXC internal: <code>lxcbr0</code><a class="headerlink" href="#lxc_internal_lxcbr0" title="Permanent link">&para;</a></h4>
<p>The <code>lxcbr0</code> bridge is required for LXC, but OpenStack-Ansible configures it automatically. It provides external (typically Internet) connectivity to containers with <code>dnsmasq (DHCP/DNS) + NAT</code>.</p>
<p>This bridge does not directly attach to any physical or logical interfaces on the host because <code>iptables</code> handles connectivity. It attaches to <code>eth0</code> in each container.</p>
<p>The container network that the bridge attaches to is configurable in the <code>openstack_user_config.yml</code> file in the provider_networks dictionary.</p>
<h4 id="container_managementbr-mgmt">Container management:<code>br-mgmt</code><a class="headerlink" href="#container_managementbr-mgmt" title="Permanent link">&para;</a></h4>
<p>The <code>br-mgmt</code> bridge provides management of and communication between the infrastructure and OpenStack services.</p>
<p>The bridge attaches to a physical or logical interface, typically a <code>bond0 VLAN subinterface</code>. It also attaches to <code>eth1</code> in each container.</p>
<p>The container network interface that the bridge attaches to is configurable in the <code>openstack_user_config.yml</code> file.</p>
<h4 id="storagebr-storage">Storage:<code>br-storage</code><a class="headerlink" href="#storagebr-storage" title="Permanent link">&para;</a></h4>
<p>The <code>br-storage</code> bridge provides segregated access to Block Storage devices between OpenStack services and Block Storage devices.</p>
<p>The bridge attaches to a physical or logical interface, typically a <code>bond0 VLAN subinterface</code>. It also attaches to <code>eth2</code> in each associated container.</p>
<p>The container network interface that the bridge attaches to is configurable in the <code>openstack_user_config.yml</code> file.</p>
<h4 id="openstack_networking_tunnelbr-vxlan">OpenStack Networking tunnel:<code>br-vxlan</code><a class="headerlink" href="#openstack_networking_tunnelbr-vxlan" title="Permanent link">&para;</a></h4>
<p>The <code>br-vxlan</code> bridge is required if the environment is configured to allow projects to create virtual networks using <code>VXLAN</code>. It provides the interface for virtual (<code>VXLAN</code>) tunnel networks.</p>
<p>The bridge attaches to a physical or logical interface, typically a <code>bond1 VLAN subinterface</code>. It also attaches to <code>eth10</code> in each associated container.</p>
<p>The container network interface it attaches to is configurable in the <code>openstack_user_config.yml</code> file.</p>
<h4 id="openstack_networking_providerbr-vlan">OpenStack Networking provider:<code>br-vlan</code><a class="headerlink" href="#openstack_networking_providerbr-vlan" title="Permanent link">&para;</a></h4>
<p>The <code>br-vlan</code> bridge is provides infrastructure for <code>VLAN</code> tagged or flat (no <code>VLAN</code> tag) networks.</p>
<p>The bridge attaches to a physical or logical interface, typically <code>bond1</code>. It attaches to <code>eth11</code> for VLAN type networks in each associated container. It is not assigned an IP address because it handles only layer 2 connectivity.</p>
<p>The container network interface that the bridge attaches to is configurable in the <code>openstack_user_config.yml</code> file.</p>
<h3 id="network_architecture">Network Architecture<a class="headerlink" href="#network_architecture" title="Permanent link">&para;</a></h3>
<p>In our test environment each has a dual port Ethernet card and we will configure our test environment network as a multiple interfaces as depicted by the diagram below.</p>
<p><img alt="zoomify" src="../img/multiple-interfaces.jpg" /></p>
<h3 id="network_cidrvlan_assignments">Network CIDR/VLAN Assignments<a class="headerlink" href="#network_cidrvlan_assignments" title="Permanent link">&para;</a></h3>
<p>The following CIDR and VLAN assignments are used for this environment.</p>
<table>
<thead>
<tr>
<th><strong>Network</strong></th>
<th><strong>CIDR</strong></th>
<th><strong>VLAN</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Management Network</td>
<td><code>172.29.236.0/22</code></td>
<td><code>10</code></td>
</tr>
<tr>
<td>Tunnel (VXLAN) Network</td>
<td><code>172.29.240.0/22</code></td>
<td><code>30</code></td>
</tr>
<tr>
<td>Storage Network</td>
<td><code>172.29.244.0/22</code></td>
<td><code>20</code></td>
</tr>
</tbody>
</table>
<h3 id="ip_assignments">IP Assignments<a class="headerlink" href="#ip_assignments" title="Permanent link">&para;</a></h3>
<p>The following host name and IP address assignments are used for this environment.</p>
<table>
<thead>
<tr>
<th><strong>Host name</strong></th>
<th><strong>Management IP</strong></th>
<th><strong>Tunnel (VxLAN) I/P</strong></th>
<th><strong>Storage IP</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>infra1</code></td>
<td><code>172.29.236.11</code></td>
<td><code>172.29.240.11</code></td>
<td><code>172.29.244.11</code></td>
</tr>
<tr>
<td><code>compute1</code></td>
<td><code>172.29.236.12</code></td>
<td><code>172.29.240.12</code></td>
<td><code>172.29.244.12</code></td>
</tr>
<tr>
<td><code>storage1</code></td>
<td><code>172.29.236.13</code></td>
<td><code>-</code></td>
<td><code>172.29.244.13</code></td>
</tr>
</tbody>
</table>
<h3 id="configuring_the_operating_system">Configuring the Operating System<a class="headerlink" href="#configuring_the_operating_system" title="Permanent link">&para;</a></h3>
<p>This section covers how to install and configure <strong>Ubuntu 18.04 LTS server</strong> in our OpenStack-Ansible host.</p>
<h3 id="install_the_operating_system">Install the Operating System<a class="headerlink" href="#install_the_operating_system" title="Permanent link">&para;</a></h3>
<p>If your have downloaded your Ubuntu server image download the installation ISO from alternate download section.</p>
<h4 id="alternative_ubuntu_server_installer">Alternative Ubuntu Server installer<a class="headerlink" href="#alternative_ubuntu_server_installer" title="Permanent link">&para;</a></h4>
<p>Since we  require advanced networking and storage features such as; LVM, RAID, multipath, vlans, bonds, or re-using existing partitions, you will want to continue to use the alternate installer. Pannipitiya</p>
<p><a href="http://cdimage.ubuntu.com/releases/18.04.2/release/ubuntu-18.04.2-server-amd64.iso">Download the alternate installer</a></p>
<h4 id="suggested_partitions_scheme_for_openstack_nodes">Suggested Partitions Scheme for OpenStack Nodes.<a class="headerlink" href="#suggested_partitions_scheme_for_openstack_nodes" title="Permanent link">&para;</a></h4>
<p>We  recommend you the following partitions scheme for your node installation. We will be using LVM devices created on a Volume Group by the short  hostname (<code>hostname -s</code>) of the system. For example <code>vg_infra1</code>  for <code>infra1</code>.</p>
<table>
<thead>
<tr>
<th><strong>Device</strong></th>
<th><strong>Size</strong></th>
<th><strong>Type</strong></th>
<th><strong>Mount Point</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>/dev/vg_infra1/lv_boot</code></td>
<td><code>200MB</code></td>
<td><code>EXT4</code></td>
<td><code>/boot</code></td>
</tr>
<tr>
<td><code>/dev/vg_infra1/lv_swap</code></td>
<td><code>RAM+2G</code></td>
<td><code>EXT4</code></td>
<td><code>none</code></td>
</tr>
<tr>
<td><code>/dev/vg_infra1/lv_root</code></td>
<td><code>100G</code></td>
<td><code>EXT4</code></td>
<td><code>/</code></td>
</tr>
</tbody>
</table>
<p>You need to apply the same above  for the <code>compute1</code> and <code>storage1</code> nodes as well.</p>
<div class="admonition important">
<p class="admonition-title">Setting root access in Ubuntu</p>
<p>During the default installation of <code>Ubuntu</code> server we do not have an option for setting <code>root password</code>. Suggested <code>admin</code> account during the installation is <code>ostack</code> with password of your choice. Once the installation is over logging to your admin account and set a password for the <code>root</code> account. Also enable <code>PermitRootLogin yes</code> in <code>/etc/ssh/sshd_config</code> to enable <code>root</code> access via <code>ssh</code> as we require it during the deployment via Ansible play playbooks</p>
</div>
<div class="admonition info">
<p class="admonition-title">Remaining space of the OS diks</p>
<p>Keep the remaining space in-allocated since we are going to use them later for few other uses</p>
</div>
<div class="admonition note">
<p class="admonition-title">Installing Ubuntu Server</p>
<p>We do not cover on how to install the Ubuntu server here. We assume that you already know howto do it.</p>
</div>
<div class="admonition important">
<p class="admonition-title">Language and locales setting</p>
<p>We also recommend setting your locale to en_US.UTF-8. Other locales might work, but they are not tested or supported.</p>
</div>
<h4 id="configure_ubuntu">Configure Ubuntu<a class="headerlink" href="#configure_ubuntu" title="Permanent link">&para;</a></h4>
<p><strong>1.</strong> Update package source lists
<div class="codehilite"><pre><span></span>sudo apt-get update
</pre></div>
<strong>2.</strong> Upgrade the system packages and kernel:
<div class="codehilite"><pre><span></span>sudo apt-get dist-upgrade
</pre></div>
<strong>3.</strong> Reboot the host.
<div class="codehilite"><pre><span></span>sudo systemctl reboot
</pre></div>
<strong>4.</strong> Ensure that the kernel version is <code>3.13.0-34-generic</code> or later:
<div class="codehilite"><pre><span></span>uname -r .
</pre></div>
<strong>5.</strong> Install additional software packages:
<div class="codehilite"><pre><span></span>sudo apt-get install bridge-utils debootstrap ifenslave ifenslave-2.6 lsof lvm2 chrony openssh-server sudo tcpdump vlan python
</pre></div>
<strong>6.</strong>  Install the kernel extra package if you have one for your kernel version
<div class="codehilite"><pre><span></span>sudo apt install linux-image-extra-$(uname -r)
</pre></div>
<strong>7.</strong> Add the appropriate kernel modules to the <code>/etc/modules</code> file to enable VLAN and bond interfaces:
<div class="codehilite"><pre><span></span>sudo echo &#39;bonding&#39; &gt;&gt; /etc/modules &amp;&amp; sudo  echo &#39;8021q&#39; &gt;&gt; /etc/modules
</pre></div>
<strong>8.</strong> Configure Network Time Protocol (NTP) in <code>/etc/chrony/chrony.conf</code> to synchronize with a suitable time source and restart the service:
<div class="codehilite"><pre><span></span>sudo systemctl enable chrony
sudo restart chrony
``` Pannipitiya
**9\.** Reboot the host to activate the changes and use the new kernel.
</pre></div>
sudo systemctl reboot
<div class="codehilite"><pre><span></span>##  Configure The Network  Interfaces.

This secti Pannipitiyaon describes how to configure network interfaces of your host so that it can be used in OpenStack Ansible deployment.

### Changing `netplan` to `ifupdown`

The classic `ifupdown` network configuration used in Debian/Ubuntu  has been replaced by `netplan` on Ubuntu 18.04 server system.

You can view the current `netplan` configuration using  the command below. You may have a different name for your `YML` as per your installation environment.
</pre></div>
cat /etc/netplan/01-netcfg.yaml
<div class="codehilite"><pre><span></span>You will get an output like below.
</pre></div></p>
<h2 id="this_file_describes_the_network_interfaces_available_on_your_system">This file describes the network interfaces available on your system<a class="headerlink" href="#this_file_describes_the_network_interfaces_available_on_your_system" title="Permanent link">&para;</a></h2>
<h2 id="for_more_information_see_netplan5">For more information, see netplan(5).<a class="headerlink" href="#for_more_information_see_netplan5" title="Permanent link">&para;</a></h2>
<p>network:
  version: 2
  renderer: networkd
  ethernets:
    enp0s3:
      dhcp4: yes
<div class="codehilite"><pre><span></span>To re-enable `ifupdown` on this system, run:
</pre></div>
sudo apt install ifupdown
<div class="codehilite"><pre><span></span>### Consistent Naming for Network Interfaces

New versions of Linux Kernel, including the one in our Ubuntu server name the network interfaces using a new convention based on the network interface type (PCI, PCIe, Onboard, Wireless, etc.,) and the relative position of the motherboard which we have slotted the specific card. For example, you may get interface names like `enp0s3, eno1, p2p1` etc. While this is an advantageous in many cases as it provides consist ant name of each interface during our OpenStack-Ansible deployment we are going to rename them back to our traditional naming convention `eth0, eth1`, and so on.

To get back to `ethX` again will do the following configurations
</pre></div>
sudo nano /etc/default/grub
<div class="codehilite"><pre><span></span>Look for `GRUB_CMDLINE_LINUX`  and add the following `net.ifnames=0 biosdevname=0`.

**From:**
</pre></div>
GRUB_CMDLINE_LINUX=""
<div class="codehilite"><pre><span></span>**To:**
</pre></div>
GRUB_CMDLINE_LINUX="net.ifnames=0 biosdevname=0"
<div class="codehilite"><pre><span></span>Generate a new grub file using the following command.
</pre></div>
sudo grub-mkconfig -o /boot/grub/grub.cfg
<div class="codehilite"><pre><span></span>Now reboot your systems
</pre></div>
sudo systemctl reboot
<div class="codehilite"><pre><span></span>Now check your interface name:
</pre></div>
ip link show
<div class="codehilite"><pre><span></span>You should get an output like below:
</pre></div>
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN mode DEFAULT group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP mode DEFAULT group default qlen 1000
    link/ether 08:00:27:cb:31:f1 brd ff:ff:ff:ff:ff:ff
3: eth1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP mode DEFAULT group default qlen 1000
    link/ether 08:00:27:b4:05:38 brd ff:ff:ff:ff:ff:ff
<div class="codehilite"><pre><span></span>### Infra1 Host Networking

According to above network architecture and design you can configure the network interfaces of infra1 host as below.
</pre></div>
sudo nano /etc/network/interfaces
<div class="codehilite"><pre><span></span>Add the the following configurations.
</pre></div></p>
<h2 id="physical_interfaces">Physical interfaces<a class="headerlink" href="#physical_interfaces" title="Permanent link">&para;</a></h2>
<p>auto eth0
iface eth0 inet manual</p>
<p>auto eth1
iface eth1 inet manual</p>
<h2 id="containerhost_management_vlan_interface">Container/Host management VLAN interface<a class="headerlink" href="#containerhost_management_vlan_interface" title="Permanent link">&para;</a></h2>
<p>auto eth0.10
iface eth0.10 inet manual
    vlan-raw-device eth0</p>
<h2 id="openstack_networking_vxlan_tunneloverlay_vlan_interface">OpenStack Networking VXLAN (tunnel/overlay) VLAN interface<a class="headerlink" href="#openstack_networking_vxlan_tunneloverlay_vlan_interface" title="Permanent link">&para;</a></h2>
<p>auto eth1.30
iface eth1.30 inet manual
    vlan-raw-device eth1</p>
<h2 id="storage_network_vlan_interface_optional">Storage network VLAN interface (optional)<a class="headerlink" href="#storage_network_vlan_interface_optional" title="Permanent link">&para;</a></h2>
<p>auto eth0.20
iface eth0.20 inet manual
    vlan-raw-device eth0</p>
<h2 id="containerhost_management_bridge">Container/Host management bridge<a class="headerlink" href="#containerhost_management_bridge" title="Permanent link">&para;</a></h2>
<p>auto br-mgmt
iface br-mgmt inet static
    bridge_stp off
    bridge_waitport 0
    bridge_fd 0
    bridge_ports eth0.10
    address 172.29.236.11
    netmask 255.255.252.0
    dns-nameservers 8.8.8.8 8.8.4.4</p>
<h2 id="bind_the_internal_lb_vip_as_we_run_haproxy_without_keepalived">Bind the Internal LB VIP as we run haproxy without keepalived<a class="headerlink" href="#bind_the_internal_lb_vip_as_we_run_haproxy_without_keepalived" title="Permanent link">&para;</a></h2>
<p>auto br-mgmt:0
iface br-mgmt:0 inet static
    address 172.29.236.10
    netmask 255.255.252.0</p>
<h2 id="bind_the_external_lb_vip_as_we_run_haproxy_without_keepalived">Bind the External LB VIP as we run haproxy without keepalived<a class="headerlink" href="#bind_the_external_lb_vip_as_we_run_haproxy_without_keepalived" title="Permanent link">&para;</a></h2>
<p>auto eth1:0
iface eth1:0 inet static
    address 192.168.10.10
    netmask 255.255.255.0</p>
<h2 id="external_network_access_for_floating_ip">External Network access for Floating IP<a class="headerlink" href="#external_network_access_for_floating_ip" title="Permanent link">&para;</a></h2>
<p>auto eth1
face eth1 inet static
   address 192.168.10.11
   netmask 255.255.255.0
   gateway 192.168.10.1
   dns-nameservers 8.8.8.8 8.8.4.4</p>
<h2 id="openstack_networking_vxlan_tunneloverlay_bridge">OpenStack Networking VXLAN (tunnel/overlay) bridge<a class="headerlink" href="#openstack_networking_vxlan_tunneloverlay_bridge" title="Permanent link">&para;</a></h2>
<h2 id="_1"><a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<h2 id="the_compute_network_and_infra_nodes_must_have_an_ip_address">The COMPUTE, NETWORK and INFRA nodes must have an IP address<a class="headerlink" href="#the_compute_network_and_infra_nodes_must_have_an_ip_address" title="Permanent link">&para;</a></h2>
<h2 id="on_this_bridge">on this bridge.<a class="headerlink" href="#on_this_bridge" title="Permanent link">&para;</a></h2>
<h2 id="_2"><a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<p>auto br-vxlan
iface br-vxlan inet static
    bridge_stp off
    bridge_waitport 0
    bridge_fd 0
    bridge_ports eth1.30
    address 172.29.240.11
    netmask 255.255.252.0</p>
<h2 id="openstack_networking_vlan_bridge">OpenStack Networking VLAN bridge<a class="headerlink" href="#openstack_networking_vlan_bridge" title="Permanent link">&para;</a></h2>
<p>auto br-vlan
iface br-vlan inet manual
    bridge_stp off
    bridge_waitport 0
    bridge_fd 0
    bridge_ports eth1</p>
<h2 id="storage_bridge_optional">Storage bridge (optional)<a class="headerlink" href="#storage_bridge_optional" title="Permanent link">&para;</a></h2>
<h2 id="_3"><a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
<h2 id="only_the_compute_and_storage_nodes_must_have_an_ip_address">Only the COMPUTE and STORAGE nodes must have an IP address<a class="headerlink" href="#only_the_compute_and_storage_nodes_must_have_an_ip_address" title="Permanent link">&para;</a></h2>
<h2 id="on_this_bridge_when_used_by_infrastructure_nodes_the">on this bridge. When used by infrastructure nodes, the<a class="headerlink" href="#on_this_bridge_when_used_by_infrastructure_nodes_the" title="Permanent link">&para;</a></h2>
<h2 id="ip_addresses_are_assigned_to_containers_which_use_this">IP addresses are assigned to containers which use this<a class="headerlink" href="#ip_addresses_are_assigned_to_containers_which_use_this" title="Permanent link">&para;</a></h2>
<h2 id="bridgedeploying_and_customizing_openstack_mitaka_with_openstack-ansible">bridge.Deploying and customizing OpenStack Mitaka with openstack-ansible<a class="headerlink" href="#bridgedeploying_and_customizing_openstack_mitaka_with_openstack-ansible" title="Permanent link">&para;</a></h2>
<h2 id="_4"><a class="headerlink" href="#_4" title="Permanent link">&para;</a></h2>
<h2 id="storage_bridge">Storage bridge<a class="headerlink" href="#storage_bridge" title="Permanent link">&para;</a></h2>
<p>auto br-storage
iface br-storage inet static
    bridge_stp off
    bridge_waitport 0
    bridge_fd 0
    bridge_ports eth0.20
    address 172.29.244.11
    netmask 255.255.252.0
<div class="codehilite"><pre><span></span>Reboot the system
</pre></div>
sudo systemctl reboot
<div class="codehilite"><pre><span></span>###  Compute1 Host Networking

According to above network architecture and design you can configure the network interfaces of Compute1 host as below.
</pre></div>
sudo nano /etc/network/interfaces
<div class="codehilite"><pre><span></span>Add the the following configurations.
</pre></div></p>
<h2 id="physical_interfaces_1">Physical interfaces<a class="headerlink" href="#physical_interfaces_1" title="Permanent link">&para;</a></h2>
<p>auto eth0
iface eth0 inet manual</p>
<p>auto eth1
iface eth1 inet manual</p>
<h2 id="containerhost_management_vlan_interface_1">Container/Host management VLAN interface<a class="headerlink" href="#containerhost_management_vlan_interface_1" title="Permanent link">&para;</a></h2>
<p>auto eth0.10
iface eth0.10 inet manual
    vlan-raw-device eth0</p>
<h2 id="openstack_networking_vxlan_tunneloverlay_vlan_interface_1">OpenStack Networking VXLAN (tunnel/overlay) VLAN interface<a class="headerlink" href="#openstack_networking_vxlan_tunneloverlay_vlan_interface_1" title="Permanent link">&para;</a></h2>
<p>auto eth1.30
iface eth1.30 inet manual
    vlan-raw-device eth1</p>
<h2 id="storage_network_vlan_interface_optional_1">Storage network VLAN interface (optional)<a class="headerlink" href="#storage_network_vlan_interface_optional_1" title="Permanent link">&para;</a></h2>
<p>auto eth0.20
iface eth0.20 inet manual
    vlan-raw-device eth0</p>
<h2 id="containerhost_management_bridge_1">Container/Host management bridge<a class="headerlink" href="#containerhost_management_bridge_1" title="Permanent link">&para;</a></h2>
<p>auto br-mgmt
iface br-mgmt inet static
    bridge_stp off
    bridge_waitport 0
    bridge_fd 0
    bridge_ports eth0.10
    address 172.29.236.12
    netmask 255.255.252.0
    gateway 172.29.236.1
    dns-nameservers 8.8.8.8 8.8.4.4</p>
<h2 id="external_network_access_for_floating_ip_1">External Network access for Floating IP<a class="headerlink" href="#external_network_access_for_floating_ip_1" title="Permanent link">&para;</a></h2>
<p>auto eth1
face eth1 inet static
   address 192.168.10.12
   netmask 255.255.255.0
   gateway 192.168.10.1
   dns-nameservers 8.8.8.8 8.8.4.4</p>
<h2 id="openstack_networking_vxlan_tunneloverlay_bridge_1">OpenStack Networking VXLAN (tunnel/overlay) bridge<a class="headerlink" href="#openstack_networking_vxlan_tunneloverlay_bridge_1" title="Permanent link">&para;</a></h2>
<h2 id="_5"><a class="headerlink" href="#_5" title="Permanent link">&para;</a></h2>
<h2 id="the_compute_network_and_infra_nodes_must_have_an_ip_address_1">The COMPUTE, NETWORK and INFRA nodes must have an IP address<a class="headerlink" href="#the_compute_network_and_infra_nodes_must_have_an_ip_address_1" title="Permanent link">&para;</a></h2>
<h2 id="on_this_bridge_1">on this bridge.<a class="headerlink" href="#on_this_bridge_1" title="Permanent link">&para;</a></h2>
<h2 id="_6"><a class="headerlink" href="#_6" title="Permanent link">&para;</a></h2>
<p>auto br-vxlan
iface br-vxlan inet static
    bridge_stp off
    bridge_waitport 0
    bridge_fd 0
    bridge_ports eth1.30
    address 172.29.240.12
    netmask 255.255.252.0</p>
<h2 id="openstack_networking_vlan_bridge_1">OpenStack Networking VLAN bridge<a class="headerlink" href="#openstack_networking_vlan_bridge_1" title="Permanent link">&para;</a></h2>
<p>auto br-vlan
iface br-vlan inet manual
    bridge_stp off
    bridge_waitport 0
    bridge_fd 0
    bridge_ports eth1</p>
<h2 id="for_tenant_vlan_support_create_a_veth_pair_to_be_used_when_the_neutron">For tenant vlan support, create a veth pair to be used when the neutron<a class="headerlink" href="#for_tenant_vlan_support_create_a_veth_pair_to_be_used_when_the_neutron" title="Permanent link">&para;</a></h2>
<h2 id="agent_is_not_containerized_on_the_compute_hosts_eth12_is_the_value_used_on">agent is not containerized on the compute hosts. 'eth12' is the value used on<a class="headerlink" href="#agent_is_not_containerized_on_the_compute_hosts_eth12_is_the_value_used_on" title="Permanent link">&para;</a></h2>
<h2 id="the_host_bind_override_parameter_of_the_br-vlan_network_section_of_the">the host_bind_override parameter of the br-vlan network section of the<a class="headerlink" href="#the_host_bind_override_parameter_of_the_br-vlan_network_section_of_the" title="Permanent link">&para;</a></h2>
<h2 id="openstack_user_config_example_file_the_veth_peer_name_must_match_the_value">openstack_user_config example file. The veth peer name must match the value<a class="headerlink" href="#openstack_user_config_example_file_the_veth_peer_name_must_match_the_value" title="Permanent link">&para;</a></h2>
<h2 id="specified_on_the_host_bind_override_parameter">specified on the host_bind_override parameter.<a class="headerlink" href="#specified_on_the_host_bind_override_parameter" title="Permanent link">&para;</a></h2>
<h2 id="_7"><a class="headerlink" href="#_7" title="Permanent link">&para;</a></h2>
<h2 id="when_the_neutron_agent_is_containerized_it_will_use_the_container_interface">When the neutron agent is containerized it will use the container_interface<a class="headerlink" href="#when_the_neutron_agent_is_containerized_it_will_use_the_container_interface" title="Permanent link">&para;</a></h2>
<h2 id="value_of_the_br-vlan_network_which_is_also_the_same_eth12_value">value of the br-vlan network, which is also the same 'eth12' value.<a class="headerlink" href="#value_of_the_br-vlan_network_which_is_also_the_same_eth12_value" title="Permanent link">&para;</a></h2>
<h2 id="_8"><a class="headerlink" href="#_8" title="Permanent link">&para;</a></h2>
<h2 id="create_veth_pair_do_not_abort_if_already_exists">Create veth pair, do not abort if already exists<a class="headerlink" href="#create_veth_pair_do_not_abort_if_already_exists" title="Permanent link">&para;</a></h2>
<h2 id="pre-up_ip_link_add_br-vlan-veth_type_veth_peer_name_eth12_true">pre-up ip link add br-vlan-veth type veth peer name eth12 || true<a class="headerlink" href="#pre-up_ip_link_add_br-vlan-veth_type_veth_peer_name_eth12_true" title="Permanent link">&para;</a></h2>
<h2 id="set_both_ends_up">Set both ends UP<a class="headerlink" href="#set_both_ends_up" title="Permanent link">&para;</a></h2>
<h2 id="pre-up_ip_link_set_br-vlan-veth_up">pre-up ip link set br-vlan-veth up<a class="headerlink" href="#pre-up_ip_link_set_br-vlan-veth_up" title="Permanent link">&para;</a></h2>
<h2 id="pre-up_ip_link_set_eth12_up">pre-up ip link set eth12 up<a class="headerlink" href="#pre-up_ip_link_set_eth12_up" title="Permanent link">&para;</a></h2>
<h2 id="delete_veth_pair_on_down">Delete veth pair on DOWN<a class="headerlink" href="#delete_veth_pair_on_down" title="Permanent link">&para;</a></h2>
<h2 id="post-down_ip_link_del_br-vlan-veth_true">post-down ip link del br-vlan-veth || true<a class="headerlink" href="#post-down_ip_link_del_br-vlan-veth_true" title="Permanent link">&para;</a></h2>
<h2 id="bridge_ports_eth0_br-vlan-veth">bridge_ports eth0 br-vlan-veth<a class="headerlink" href="#bridge_ports_eth0_br-vlan-veth" title="Permanent link">&para;</a></h2>
<h2 id="storage_bridge_optional_1">Storage bridge (optional)<a class="headerlink" href="#storage_bridge_optional_1" title="Permanent link">&para;</a></h2>
<h2 id="_9"><a class="headerlink" href="#_9" title="Permanent link">&para;</a></h2>
<h2 id="only_the_compute_and_storage_nodes_must_have_an_ip_address_1">Only the COMPUTE and STORAGE nodes must have an IP address<a class="headerlink" href="#only_the_compute_and_storage_nodes_must_have_an_ip_address_1" title="Permanent link">&para;</a></h2>
<h2 id="on_this_bridge_when_used_by_infrastructure_nodes_the_1">on this bridge. When used by infrastructure nodes, the<a class="headerlink" href="#on_this_bridge_when_used_by_infrastructure_nodes_the_1" title="Permanent link">&para;</a></h2>
<h2 id="ip_addresses_are_assigned_to_containers_which_use_this_1">IP addresses are assigned to containers which use this<a class="headerlink" href="#ip_addresses_are_assigned_to_containers_which_use_this_1" title="Permanent link">&para;</a></h2>
<h2 id="bridgedeploying_and_customizing_openstack_mitaka_with_openstack-ansible_1">bridge.Deploying and customizing OpenStack Mitaka with openstack-ansible<a class="headerlink" href="#bridgedeploying_and_customizing_openstack_mitaka_with_openstack-ansible_1" title="Permanent link">&para;</a></h2>
<h2 id="_10"><a class="headerlink" href="#_10" title="Permanent link">&para;</a></h2>
<h2 id="storage_bridge_1">Storage bridge<a class="headerlink" href="#storage_bridge_1" title="Permanent link">&para;</a></h2>
<p>auto br-storage
iface br-storage inet static
    bridge_stp off
    bridge_waitport 0
    bridge_fd 0
    bridge_ports eth0.20
    address 172.29.244.12
    netmask 255.255.252.0
<div class="codehilite"><pre><span></span>Reboot the system
</pre></div>
sudo systemctl reboot
<div class="codehilite"><pre><span></span>###  Storage1 Host Networking

According to above network architecture and design you can configure the network interfaces of Host1 host as below.
</pre></div>
sudo nano /etc/network/interfaces
<div class="codehilite"><pre><span></span>Add the the following configurations.
</pre></div></p>
<h2 id="physical_interfaces_2">Physical interfaces<a class="headerlink" href="#physical_interfaces_2" title="Permanent link">&para;</a></h2>
<p>auto eth0
iface eth0 inet manual</p>
<p>auto eth1
iface eth1 inet manual</p>
<h2 id="containerhost_management_vlan_interface_2">Container/Host management VLAN interface<a class="headerlink" href="#containerhost_management_vlan_interface_2" title="Permanent link">&para;</a></h2>
<p>auto eth0.10
iface eth0.10 inet manual
    vlan-raw-device eth0</p>
<h2 id="openstack_networking_vxlan_tunneloverlay_vlan_interface_2">OpenStack Networking VXLAN (tunnel/overlay) VLAN interface<a class="headerlink" href="#openstack_networking_vxlan_tunneloverlay_vlan_interface_2" title="Permanent link">&para;</a></h2>
<p>auto eth1.30
iface eth1.30 inet manual
    vlan-raw-device eth1</p>
<h2 id="storage_network_vlan_interface_optional_2">Storage network VLAN interface (optional)<a class="headerlink" href="#storage_network_vlan_interface_optional_2" title="Permanent link">&para;</a></h2>
<p>auto eth0.20
iface eth0.20 inet manual
    vlan-raw-device eth0</p>
<h2 id="containerhost_management_bridge_2">Container/Host management bridge<a class="headerlink" href="#containerhost_management_bridge_2" title="Permanent link">&para;</a></h2>
<p>auto br-mgmt
iface br-mgmt inet static
    bridge_stp off
    bridge_waitport 0
    bridge_fd 0
    bridge_ports eth0.10
    address 172.29.236.13
    netmask 255.255.252.0
    gateway 172.29.236.1
    dns-nameservers 8.8.8.8 8.8.4.4</p>
<h2 id="storage_bridge_2">Storage bridge<a class="headerlink" href="#storage_bridge_2" title="Permanent link">&para;</a></h2>
<p>auto br-storage
iface br-storage inet static
    bridge_stp off
    bridge_waitport 0
    bridge_fd 0
    bridge_ports eth0.20
    address 172.29.244.13
    netmask 255.255.252.0
<div class="codehilite"><pre><span></span>Reboot the system
</pre></div>
sudo systemctl reboot
<div class="codehilite"><pre><span></span>## Configure SSH keys

Ansible uses SSH to connect the deployment host and target hosts.

In this test environment we use `infra1` host as  our `OpenStack-ansible` host we will create a `ssh` key pair as the root user and propagate the public key of the root user to `compute1` and `storage1` hosts.

**1\.** &#39;Run the following command as `root` user in `infra1` host
</pre></div>
sudo su -
ssh-keygen -t rsa
<div class="codehilite"><pre><span></span>Press `Enter` key to create our keys without a passphrase

You will get an output like below.

```Note

OpenStack-Ansible automatically configures LVM on the nodes, and overrides any existing LVM configuration. If you had a customized LVM configuration, edit the generated configuration file as needed.


root@guru:~# ssh-keygen -t rsa
Generating public/private rsa key pair.
Enter file in which to save the key (/root/.ssh/id_rsa):
Enter passphrase (empty for no passphrase):
Enter same passphrase again:
Your identification has been saved in /root/.ssh/id_rsa.
Your public key has been saved in /root/.ssh/id_rsa.pub.
The key fingerprint is:
SHA256:WpPMnxdgptMOBoV+qcSgO8qQDWZjtEtfmsB08A5Zr6s root@guru
The key&#39;s randomart image is:
+---[RSA 2048]----+
| ...   ..        |
| o+.o ..         |
|+ooo =.  .+      |
|.X+ ..++o* .     |
|=+=++. oS . .    |
|o.++. .+ * . .   |
|o. o  .   + .    |
|...        .     |
| E               |
+----[SHA256]-----+
</pre></div></p>
<p><strong>2.</strong> Copy the keys to compute1 and storage1 hosts.
<div class="codehilite"><pre><span></span>ssh-copy-id root@compute1
ssh-copy-id root@storage1
</pre></div></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We assume that  you have configured your DNS or at least <code>/etc/hosts</code> file to resolve hostnames</p>
</div>
<p><strong>3.</strong> Test it
<div class="codehilite"><pre><span></span>ssh root@compute1
ssh root@Storage1
</pre></div>
If you can connect and get the shell without authenticating, it is working. SSH provides a shell without asking for a password.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>OpenStack-Ansible automatically configures LVM on the nodes, and overrides any existing LVM configuration. If you had a customized LVM configuration, edit the generated configuration file as needed.</p>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>OpenStack-Ansible deployments require the presence of a <code>/root/.ssh/id_rsa.pub</code> file on the deployment host. The contents of this file is inserted into an <code>authorized_keys</code> file for the containers, which is a necessary step for the Ansible playbooks. You can override this behavior by setting the <code>lxc_container_ssh_key</code> variable to the public key for the container.</p>
</div>
<h3 id="configuring_the_storage">Configuring The Storage<a class="headerlink" href="#configuring_the_storage" title="Permanent link">&para;</a></h3>
<p>Logical Volume Manager (LVM) enables a single device to be split into multiple logical volumes that appear as a physical storage device to the operating system. The Block Storage (cinder) service, and LXC containers that optionally run the OpenStack infrastructure, can optionally use LVM for their data storage.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>OpenStack-Ansible automatically configures LVM on the nodes, and overrides any existing LVM configuration. If you had a customized LVM configuration, edit the generated configuration file as needed.</p>
</div>
<p>1. To use the optional Block Storage (cinder) service, create an LVM volume group named <code>cinder-volumes</code> on the storage host. Specify a metadata size of <code>2048</code> when creating the physical volume.  For example:
<div class="codehilite"><pre><span></span>sudo pvcreate --metadatasize 2048  physical_volume_device_path (/dev/sda5)
sudo  vgcreate cinder-volumes physical_volume_device_path (/dev/sda5)
</pre></div>
2. Optionally, create an LVM volume group named <code>lxc</code> for container file systems if you want to use <code>LXC</code> with <code>LVM</code>. If the <code>lxc</code> volume group does not exist, containers are automatically installed on the file system under <code>/var/lib/lxc</code> by default.</p>
<h4 id="setup_dns_resolver">Setup DNS Resolver<a class="headerlink" href="#setup_dns_resolver" title="Permanent link">&para;</a></h4>
<p>Ubuntu 18.04 systems make a symlink to <code>`/etc/resolv.conf</code> with <code>../run/systemd/resolve/stub-resolv.conf</code> by default.</p>
<p>1. Remove symlink
<div class="codehilite"><pre><span></span>sudo rm -f /etc/resolv.conf
</pre></div>
2. Create the Resolver
<div class="codehilite"><pre><span></span>sudo echo &quot;nameserv*er 8.8.8.8&quot; &gt; /etc/resolv.conf
</pre></div>
3. Test it
<div class="codehilite"><pre><span></span>ping -c4 google.command
</pre></div>
4. Carry out above in all openstack hosts.</p>
<h3 id="setup_nat_gateway">Setup NAT Gateway.<a class="headerlink" href="#setup_nat_gateway" title="Permanent link">&para;</a></h3>
<p>In our test environment setup <code>infra1</code> host will be used as the Ansible host and it will also act as the gateway for OpenStack Ansible lxc lxc_containers. Let's to the following configurations to get this done.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>After the installation the initial setup will ask to save the current rules for <code>IPv4</code> and <code>IPv6</code>, just select <code>Yes</code> and press <code>enter</code> for both.</p>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>If you make further changes to your <code>iptables</code> rules, remember to save them again using the  command in the step 4 above. The <code>iptables-persistent</code> looks for the files <code>rules.v4</code> and <code>rules.v6</code> under <code>/etc/iptables</code>.</p>
</div>
<h3 id="setup_openstack_ansible_host">Setup  OpenStack Ansible Host<a class="headerlink" href="#setup_openstack_ansible_host" title="Permanent link">&para;</a></h3>
<p>In this example environment  we use <code>infra1</code> node  as the 'openstack-anible' host.</p>
<p>Execute the following commands in infra1 host.</p>
<p>1. Update package source lists:
<div class="codehilite"><pre><span></span>sudo apt-get update
</pre></div></p>
<p>2. Upgrade the system packages and kernel:
<div class="codehilite"><pre><span></span>sudo apt-get dist-upgrade
</pre></div></p>
<p>3. Reboot the host.
<div class="codehilite"><pre><span></span>sudo system reboot

4\. Install additional software packages if they were not installed during the operating system installation:
</pre></div>
sudo apt-get install aptitude build-essential git ntp ntpdate openssh-server python-dev sudo
<div class="codehilite"><pre><span></span>## Install the Source and Dependencies

Install the source and dependencies for the deployment host.

1\. Clone the latest stable release of the OpenStack-Ansible Git repository in the `/opt/openstack-ansible` directory:
</pre></div>
sudo su -
git clone -b 18.1.4 <a href="https://git.openstack.org/openstack/openstack-ansible">https://git.openstack.org/openstack/openstack-ansible</a> /opt/openstack-ansible
<div class="codehilite"><pre><span></span>2\. Change to the `/opt/openstack-ansible` directory, and run the Ansible bootstrap script:
</pre></div>
cd /opt/openstack-ansible
scripts/bootstrap-ansible.sh
<div class="codehilite"><pre><span></span>## Deployment Configuration

### Environment Layout

The `/etc/openstack_deploy/openstack_user_config.yml` file defines the environment layout.

The following configuration describes the layout for this environment.
</pre></div></p>
<hr />
<p>cidr_networks:
  container: 172.29.236.0/22
  tunnel: 172.29.240.0/22
  storage: 172.29.244.0/22</p>
<p>used_ips:
  - "172.29.236.1,172.29.236.50"
  - "172.29.240.1,172.29.240.50"
  - "172.29.244.1,172.29.244.50"
  - "172.29.248.1,172.29.248.50"</p>
<p>global_overrides:
  # The internal and external VIP should be different IPs, however they
  # do not need to be on separate networks.
  external_lb_vip_address: 192.168.10.10
  internal_lb_vip_address: 172.29.236.10
  management_bridge: "br-mgmt"
  provider_networks:
    - network:
        container_bridge: "br-mgmt"
        container_type: "veth"
        container_interface: "eth1"
        ip_from_q: "container"
        type: "raw"
        group_binds:
          - all_containers
          - hosts
        is_container_address: true
    - network:
        container_bridge: "br-vxlan"
        container_type: "veth"
        container_interface: "eth10"
        ip_from_q: "tunnel"
        type: "vxlan"
        range: "1:1000"
        net_name: "vxlan"
        group_binds:
          - neutron_linuxbridge_agent
    - network:
        container_bridge: "br-vlan"
        container_type: "veth"
        container_interface: "eth12"
        host_bind_override: "eth12"
        type: "flat"
        net_name: "flat"
        group_binds:
          - neutron_linuxbridge_agent
    - network:
        container_bridge: "br-vlan"
        container_type: "veth"
        container_interface: "eth11"
        type: "vlan"
        range: "101:200,301:400"
        net_name: "vlan"
        group_binds:
          - neutron_linuxbridge_agent
    - network:
        container_bridge: "br-storage"
        container_type: "veth"
        container_interface: "eth2"
        ip_from_q: "storage"
        type: "raw"
        group_binds:
          - glance_api
          - cinder_api
          - cinder_volume
          - nova_compute</p>
<h4 id="_11"><a class="headerlink" href="#_11" title="Permanent link">&para;</a></h4>
<h4 id="infrastructure">Infrastructure<a class="headerlink" href="#infrastructure" title="Permanent link">&para;</a></h4>
<h4 id="_12"><a class="headerlink" href="#_12" title="Permanent link">&para;</a></h4>
<h2 id="galera_memcache_rabbitmq_utility">galera, memcache, rabbitmq, utility<a class="headerlink" href="#galera_memcache_rabbitmq_utility" title="Permanent link">&para;</a></h2>
<p>shared-infra_hosts:
  infra1:
    ip: 172.29.236.11</p>
<h2 id="repository_apt_cache_python_packages_etc">repository (apt cache, python packages, etc)<a class="headerlink" href="#repository_apt_cache_python_packages_etc" title="Permanent link">&para;</a></h2>
<p>repo-infra_hosts:
  infra1:
    ip: 172.29.236.11</p>
<h2 id="load_balancer">load balancer<a class="headerlink" href="#load_balancer" title="Permanent link">&para;</a></h2>
<p>haproxy_hosts:
  infra1:
    ip: 172.29.236.11</p>
<h4 id="_13"><a class="headerlink" href="#_13" title="Permanent link">&para;</a></h4>
<h4 id="openstack">OpenStack<a class="headerlink" href="#openstack" title="Permanent link">&para;</a></h4>
<h4 id="_14"><a class="headerlink" href="#_14" title="Permanent link">&para;</a></h4>
<h2 id="keystone">keystone<a class="headerlink" href="#keystone" title="Permanent link">&para;</a></h2>
<p>identity_hosts:
  infra1:
    ip: 172.29.236.11</p>
<h2 id="cinder_api_services">cinder api services<a class="headerlink" href="#cinder_api_services" title="Permanent link">&para;</a></h2>
<p>storage-infra_hosts:
  infra1:
    ip: 172.29.236.11</p>
<h2 id="glance">glance<a class="headerlink" href="#glance" title="Permanent link">&para;</a></h2>
<p>image_hosts:
  infra1:
    ip: 172.29.236.11</p>
<h2 id="nova_api_conductor_etc_services">nova api, conductor, etc services<a class="headerlink" href="#nova_api_conductor_etc_services" title="Permanent link">&para;</a></h2>
<p>compute-infra_hosts:
  infra1:
    ip: 172.29.236.11</p>
<h2 id="heat">heat<a class="headerlink" href="#heat" title="Permanent link">&para;</a></h2>
<p>orchestration_hosts:
  infra1:
    ip: 172.29.236.11</p>
<h2 id="horizon">horizon<a class="headerlink" href="#horizon" title="Permanent link">&para;</a></h2>
<p>dashboard_hosts:
  infra1:
    ip: 172.29.236.11</p>
<h2 id="neutron_server_agents_l3_etc">neutron server, agents (L3, etc)<a class="headerlink" href="#neutron_server_agents_l3_etc" title="Permanent link">&para;</a></h2>
<p>network_hosts:
  infra1:
    ip: 172.29.236.11</p>
<h2 id="nova_hypervisors">nova hypervisors<a class="headerlink" href="#nova_hypervisors" title="Permanent link">&para;</a></h2>
<p>compute_hosts:
  compute1:
    ip: 172.29.236.12</p>
<h2 id="cinder_storage_host_lvm-backed">cinder storage host (LVM-backed)<a class="headerlink" href="#cinder_storage_host_lvm-backed" title="Permanent link">&para;</a></h2>
<p>storage_hosts:
  storage1:
    ip: 172.29.236.13
    container_vars:
      cinder_backends:
        limit_container_types: cinder_volume
        lvm:
          volume_group: cinder-volumes
          volume_driver: cinder.volume.drivers.lvm.LVMVolumeDriver
          volume_backend_name: LVM_iSCSI
          iscsi_ip_address: "172.29.244.13"
```</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../prepare-the-target-hosts/" title="Prepare the Target Hosts" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Prepare the Target Hosts
              </span>
            </div>
          </a>
        
        
          <a href="../install-node-os/" title="Installing Node OS" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Installing Node OS
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2018 - 2019 Chinthaka Deshapriya
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/ostackdoc" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://twitter.com/ostackdoc" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="https://linkedin.com/in/ostackdoc" class="md-footer-social__link fa fa-linkedin"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.d9aa80ab.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
  </body>
</html>